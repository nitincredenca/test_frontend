<!-- <div class="min-h-screen bg-[#EEEEEE] flex flex-col"> 
  <app-navbar [client]="client" [project]="project"></app-navbar>

  <div class="flex flex-1 overflow-hidden">
    <div class="bg-white flex-shrink-0 h-full" style="width: 538px;">
  <div class="pl-[40px] pr-4 py-6">
    <div class="space-y-6">
      
      <div class="border border-[#D3D1D1] rounded-[8px] p-3 bg-[#EEEEEE]">
        <div class="flex items-center justify-between mb-2">
          <div class="flex items-center">
            <label class="block text-[17px] leading-[20px] font-normal text-[#111111]">Style Guide <span class="text-red-500">*</span></label>
            <div class="relative flex items-center ml-1">
              <div class="style-guide-tooltip-container">
                <svg class="w-3.5 h-3.5 text-gray-400 cursor-help" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                  <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-3a1 1 0 00-.867.5 1 1 0 11-1.731-1A3 3 0 0113 8a3.001 3.001 0 01-2 2.83V11a1 1 0 11-2 0v-1a1 1 0 011-1 1 1 0 100-2zm0 8a1 1 0 100-2 1 1 0 000 2z" clip-rule="evenodd"/>
                </svg>
                <div class="tooltip">Upload your style guide to ensure content follows your brand guidelines</div>
              </div>
            </div>
          </div>
        </div>

        <div *ngIf="styleGuideFileName; else noStyleGuide" class="flex items-center justify-between">
          <span class="text-[17px] leading-[20px] font-normal text-[#878C94] truncate max-w-[140px]" [title]="styleGuideFileName">{{ styleGuideFileName }}</span>
          <button type="button" (click)="triggerStyleGuideUpload()" [disabled]="isUploadingStyleGuide"
            class="ml-2 px-3 py-1.5 text-[17px] leading-[20px] font-normal text-[#111111] border border-[#D3D1D1] rounded-[8px] bg-white hover:bg-gray-50 transition-colors disabled:opacity-50">
            <span *ngIf="!isUploadingStyleGuide">Replace</span>
            <span *ngIf="isUploadingStyleGuide">Uploading...</span>
          </button>
        </div>

        <ng-template #noStyleGuide>
          <div class="flex justify-center">
            <button type="button" (click)="triggerStyleGuideUpload()" [disabled]="isUploadingStyleGuide"
              class="px-3 py-1.5 text-[17px] leading-[20px] font-normal text-[#111111] border border-[#D3D1D1] rounded-[8px] bg-white hover:bg-gray-50 transition-colors disabled:opacity-50">
              <span *ngIf="!isUploadingStyleGuide">Upload Style Guide</span>
              <span *ngIf="isUploadingStyleGuide">Uploading...</span>
            </button>
          </div>
        </ng-template>

        <input id="style-guide-upload" type="file" class="sr-only" (change)="handleStyleGuideUpload($event)" accept=".pdf" #styleGuideInput>
      </div>

      <div>
        <div class="flex items-start">
          <label class="block text-[17px] leading-[20px] font-normal text-[#111111] mb-3">Module <span class="text-red-500">*</span></label>
          <div class="relative flex items-center ml-1 mt-0.5">
            <div class="tooltip-container">
              <svg class="w-3 h-3 text-gray-400 cursor-help" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-3a1 1 0 00-.867.5 1 1 0 11-1.731-1A3 3 0 0113 8a3.001 3.001 0 01-2 2.83V11a1 1 0 11-2 0v-1a1 1 0 011-1 1 1 0 100-2zm0 8a1 1 0 100-2 1 1 0 000 2z" clip-rule="evenodd"/>
              </svg>
              <div class="tooltip left-tooltip">Select the module where the outline is stored</div>
            </div>
          </div>
        </div>
        <select [(ngModel)]="selectedModule" (change)="onModuleChange()"
          class="w-full px-2.5 py-1.5 bg-[#EEEEEE] border border-[#D3D1D1] rounded-[8px] focus:ring-1 focus:ring-gray-400 focus:border-gray-400 transition-colors"
          style="height: 59px; font: normal normal normal 17px/20px Roboto; color: #878C94;">
          <option value="">Select a module</option>
          <option *ngFor="let module of modules" [value]="module">{{module}}</option>
        </select>
      </div>

     <div>
  <div class="flex items-start">
    <label class="block text-[17px] leading-[20px] font-normal text-[#111111] mb-3">Outline <span class="text-red-500">*</span></label>
    <div class="relative flex items-center ml-1 mt-0.5">
      <div class="tooltip-container">
        <svg class="w-3 h-3 text-gray-400 cursor-help" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
          <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-3a1 1 0 00-.867.5 1 1 0 11-1.731-1A3 3 0 0113 8a3.001 3.001 0 01-2 2.83V11a1 1 0 11-2 0v-1a1 1 0 011-1 1 1 0 100-2zm0 8a1 1 0 100-2 1 1 0 000 2z" clip-rule="evenodd"/>
        </svg>
        <div class="tooltip left-tooltip">Select an existing outline or upload a new one</div>
      </div>
    </div>
  </div>
  <select [(ngModel)]="selectedOutline"
    class="w-full px-2.5 py-1.5 bg-[#EEEEEE] border border-[#D3D1D1] rounded-[8px] focus:ring-1 focus:ring-gray-400 focus:border-gray-400 transition-colors"
    style="height: 59px; font: normal normal normal 17px/20px Roboto; color: #878C94;">
    <option value="">Select an outline</option>
    <option *ngFor="let outline of availableOutlines" [value]="outline">{{outline}}</option>
  </select>

  <div class="relative flex items-center my-3">
    <div class="flex-grow border-t border-gray-300"></div>
    <span class="flex-shrink mx-2 text-xs text-gray-500">OR</span>
    <div class="flex-grow border-t border-gray-300"></div>
  </div>
</div>
      <div>
        <div class="flex items-start">
          <label class="block text-[17px] leading-[20px] font-normal text-[#111111] mb-3">Upload Outline</label>
          <div class="relative flex items-center ml-1 mt-0.5">
            <div class="tooltip-container">
              <svg class="w-3 h-3 text-gray-400 cursor-help" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-3a1 1 0 00-.867.5 1 1 0 11-1.731-1A3 3 0 0113 8a3.001 3.001 0 01-2 2.83V11a1 1 0 11-2 0v-1a1 1 0 011-1 1 1 0 100-2zm0 8a1 1 0 100-2 1 1 0 000 2z" clip-rule="evenodd"/>
              </svg>
              <div class="tooltip left-tooltip">If you don't have an outline, you can upload a file here</div>
            </div>
          </div>
        </div>
        
        <div class="flex items-center">
          <label for="file-upload" class="cursor-pointer flex-grow">
            <span class="inline-flex items-center justify-center rounded-[8px] text-white bg-[#111111] hover:bg-black transition-colors shadow-sm" style="width: 160px; height: 42px;">
              <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"/>
              </svg>
              <span class="text-[17px] leading-[20px] font-bold">Choose File</span>
            </span>
            <span class="ml-2" style="font: normal normal normal 17px/20px Roboto; color: #878C94;" *ngIf="!uploadedFileName">No file chosen</span>
            <span class="ml-2 text-xs text-green-400 font-medium" *ngIf="uploadedFileName">{{uploadedFileName}}</span>
          </label>
          <input id="file-upload" type="file" class="sr-only" (change)="handleFileUpload($event)" accept=".doc,.docx,.pdf,.txt">
          <button *ngIf="uploadedFileName" (click)="clearFileUpload()" type="button" class="ml-1 p-1 text-gray-500 hover:text-red-400 transition-colors">✕</button>
        </div>
        
        <p class="mb-2 mt-2" style="font: normal normal normal 17px/20px Roboto; color: #878C94;">Supports: DOC & DOCX Only</p>

        <button *ngIf="uploadedFileName" [disabled]="isUploading" (click)="uploadOutline()" class="mt-3 flex justify-center items-center text-white bg-[#111111] hover:bg-black transition-colors disabled:opacity-50 w-full" style="height: 42px; border-radius: 8px;">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"/>
          </svg>
          <span class="text-[17px] leading-[20px] font-bold">{{isUploading ? 'Processing...' : 'Upload & Process'}}</span>
        </button>
      </div>

      <div>
        <div class="flex items-start">
          <label class="block text-[17px] leading-[20px] font-normal text-[#111111] mb-3">Bloom's Level <span class="text-red-500">*</span></label>
          <div class="relative flex items-center ml-1 mt-0.5">
            <div class="tooltip-container">
              <svg class="w-3 h-3 text-gray-400 cursor-help" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-3a1 1 0 00-.867.5 1 1 0 11-1.731-1A3 3 0 0113 8a3.001 3.001 0 01-2 2.83V11a1 1 0 11-2 0v-1a1 1 0 011-1 1 1 0 100-2zm0 8a1 1 0 100-2 1 1 0 000 2z" clip-rule="evenodd"/>
              </svg>
              <div class="tooltip left-tooltip">Select the complexity level based on Bloom's Taxonomy</div>
            </div>
          </div>
        </div>
        <select [(ngModel)]="bloomsLevel"
          class="w-full px-2.5 py-1.5 bg-[#EEEEEE] border border-[#D3D1D1] rounded-[8px] focus:ring-1 focus:ring-gray-400 focus:border-gray-400 transition-colors"
          style="height: 59px; font: normal normal normal 17px/20px Roboto; color: #878C94;">
          <option value="">Select level</option>
          <option *ngFor="let level of bloomsLevels" [value]="level">{{level}}</option>
        </select>
      </div>

      <div>
        <div class="flex items-start">
          <label class="block text-[17px] leading-[20px] font-normal text-[#111111] mb-3">Context Prompt</label>
          <div class="relative flex items-center ml-1 mt-0.5">
            <div class="tooltip-container">
              <svg class="w-3 h-3 text-gray-400 cursor-help" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-3a1 1 0 00-.867.5 1 1 0 11-1.731-1A3 3 0 0113 8a3.001 3.001 0 01-2 2.83V11a1 1 0 11-2 0v-1a1 1 0 011-1 1 1 0 100-2zm0 8a1 1 0 100-2 1 1 0 000 2z" clip-rule="evenodd"/>
              </svg>
              <div class="tooltip left-tooltip text-xs leading-snug">
                <strong>Add context for storyboard generation. Examples:</strong><br>• Create a storyboard with limited on-screen text (OST)<br>• Create a storyboard with limited narration<br>• Create a storyboard including both OST and narration verbatim<br>• Create a non-audio storyboard for a level 2 course<br>• Create a storyboard for a scenario-based module<br>• Create a storyboard with simulations in both show-me and try-me modes<br>• Create a storyboard where all knowledge checks are scenario-based<br>• Create a storyboard in a conversational tone
              </div>
            </div>
          </div>
        </div>
        <textarea [(ngModel)]="contextPrompt" rows="3"
          class="w-full px-2.5 py-1.5 bg-[#EEEEEE] border border-[#D3D1D1] rounded-[8px] focus:ring-1 focus:ring-gray-400 focus:border-gray-400"
          placeholder="Enter any additional context or instructions..."
          style="height: 84px; font: normal normal normal 17px/20px Roboto; color: #878C94;"></textarea>
      </div>

      <div class="space-y-3">
        <div class="flex items-center">
          <input [(ngModel)]="isNASBA" id="nasba-checkbox" type="checkbox" class="h-4 w-4 border-[#D3D1D1] rounded accent-purple-500">
          <label for="nasba-checkbox" class="ml-2 block text-[17px] leading-[20px] font-normal text-[#111111]">NASBA Compliant</label>
          <div class="relative flex items-center ml-1">
            <div class="tooltip-container">
              <svg class="w-3 h-3 text-gray-400 cursor-help" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-3a1 1 0 00-.867.5 1 1 0 11-1.731-1A3 3 0 0113 8a3.001 3.001 0 01-2 2.83V11a1 1 0 11-2 0v-1a1 1 0 011-1 1 1 0 100-2zm0 8a1 1 0 100-2 1 1 0 000 2z" clip-rule="evenodd"/>
              </svg>
              <div class="tooltip left-tooltip">Ensure content meets National Association of State Boards of Accountancy standards</div>
            </div>
          </div>
        </div>
        <div class="flex items-center">
          <input [(ngModel)]="isUKEnglish" id="uk-english-checkbox" type="checkbox" class="h-4 w-4 border-[#D3D1D1] rounded accent-purple-500">
          <label for="uk-english-checkbox" class="ml-2 block text-[17px] leading-[20px] font-normal text-[#111111]">UK English</label>
          <div class="relative flex items-center ml-1">
            <div class="tooltip-container">
              <svg class="w-3 h-3 text-gray-400 cursor-help" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-3a1 1 0 00-.867.5 1 1 0 11-1.731-1A3 3 0 0113 8a3.001 3.001 0 01-2 2.83V11a1 1 0 11-2 0v-1a1 1 0 011-1 1 1 0 100-2zm0 8a1 1 0 100-2 1 1 0 000 2z" clip-rule="evenodd"/>
              </svg>
              <div class="tooltip left-tooltip">Use UK English spelling and terminology (default is US English)</div>
            </div>
          </div>
        </div>
      </div>

      <div class="pt-3">
        <button (click)="submitStoryboard()" [disabled]="!canGenerate()" class="flex justify-center items-center text-white disabled:opacity-50 transition-colors w-full"
          style="height: 44px; border-radius: 8px; background: linear-gradient(93deg, #588AFF 0%, #8E0ED8 100%);">
          <span class="text-[17px] leading-[20px] font-bold">{{isLoading ? 'Generating...' : 'Generate Storyboard'}}</span>
        </button>
      </div>
      
    </div>
  </div>
</div>
    <div class="flex-1 flex flex-col overflow-hidden">
      <div class="flex-1 overflow-auto">
      <div class="max-w-full mx-auto px-2 sm:px-4 lg:px-6 py-4 h-full">
          <div *ngIf="!storyboards || storyboards.length === 0"
            class="bg-white p-8 rounded-xl shadow-sm border border-gray-200 text-center flex flex-col items-center">
            <div class="w-20 h-20 bg-purple-100 rounded-full flex items-center justify-center mb-4">
              <svg xmlns="http://www.w3.org/2000/svg" class="h-10 w-10 border-gray-300" fill="none" viewBox="0 0 24 24"
                stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5"
                  d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
              </svg>
            </div>
            <h3 class="text-sm font-medium text-gray-700">No storyboard generated yet</h3>
            <p class="mt-1 text-xs text-gray-500 max-w-md">Fill out the parameters and click "Generate Storyboard" to
              create your content structure.</p>
          </div>

          <div *ngIf="storyboards && storyboards.length > 0" class="space-y-4">
             <div class="bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden h-[calc(100vh-102px)] flex flex-col font-roboto">
                     
              <div class="overflow-x-auto flex-1">
                            <table class="min-w-full divide-y divide-gray-200">

                  <colgroup>
                    <col class="w-1/4">
                    <col class="w-3/4">
                  </colgroup>
              <tbody class="bg-white divide-y divide-gray-200">
                    <tr *ngIf="currentStoryboard">
                       <td class="px-4 py-3 text-left font-medium text-[#111111] align-top border-r" style="font: normal normal medium 17px/20px Roboto;">
                    Topic
                  </td>
                               
                          <td class="px-4 py-3 align-top">
                    <div *ngIf="!isEditing" style="font: normal normal normal 17px/20px Roboto; color: #878C94;">
                      {{currentStoryboard?.Topic || 'N/A'}}
                    </div>
                    <input *ngIf="isEditing" [(ngModel)]="currentStoryboard.Topic"
                      class="w-full px-3 py-2 border border-[#D3D1D1] rounded-[8px] bg-[#EEEEEE]"
                      style="font: normal normal normal 17px/20px Roboto; color: #878C94;">
                  </td>
                    </tr>

                   <tr>
                  <td class="px-4 py-3 text-left font-medium text-[#111111] align-top border-r" style="font: normal normal medium 17px/20px Roboto;">
                    Learning Objectives
                  </td>
                  <td class="px-4 py-3 align-top">
                    <div *ngIf="!isEditing" style="font: normal normal normal 17px/20px Roboto; color: #878C94;">
                      {{currentStoryboard?.Learning_Objectives || 'N/A'}}
                    </div>
                    <textarea *ngIf="isEditing" [(ngModel)]="currentStoryboard.Learning_Objectives" rows="2"
                      class="w-full px-3 py-2 border border-[#D3D1D1] rounded-[8px] bg-[#EEEEEE]"
                      style="font: normal normal normal 17px/20px Roboto; color: #878C94;"></textarea>
                  </td>
                </tr>

                     <tr>
                  <td class="px-4 py-3 text-left font-medium text-[#111111] align-top border-r" style="font: normal normal medium 17px/20px Roboto;">
                    Screen Type
                  </td>
                  <td class="px-4 py-3 align-top">
                    <div *ngIf="!isEditing" style="font: normal normal normal 17px/20px Roboto; color: #878C94;">
                      {{currentStoryboard?.Screen_type || 'N/A'}}
                    </div>
                    <input *ngIf="isEditing" [(ngModel)]="currentStoryboard.Screen_type"
                      class="w-full px-3 py-2 border border-[#D3D1D1] rounded-[8px] bg-[#EEEEEE]"
                      style="font: normal normal normal 17px/20px Roboto; color: #878C94;">
                  </td>
                </tr>

                    <tr>
                      <td class="px-4 py-3 text-left font-medium text-[#111111] align-top border-r" style="font: normal normal medium 17px/20px Roboto;">
                    On-screen Text
                  </td>
                       <td class="px-4 py-3 align-top">
                    <div *ngIf="!isEditing" style="font: normal normal normal 17px/20px Roboto; color: #878C94; white-space: pre-line;">
                      <div *ngIf="currentStoryboard?.On_screen_text">
                        <div *ngFor="let para of getParagraphs(currentStoryboard.On_screen_text)">
                          <strong>Para {{para.key}}:</strong> {{para.value}}
                        </div>
                      </div>
                    </div>
                    <textarea *ngIf="isEditing" [(ngModel)]="onScreenTextInput" rows="8"
                      class="w-full px-3 py-2 border border-[#D3D1D1] rounded-[8px] bg-[#EEEEEE]"
                      style="font: normal normal normal 17px/20px Roboto; color: #878C94;"></textarea>
                  </td>
                    </tr>

                    <tr>
                         <td class="px-4 py-3 text-left font-medium text-[#111111] align-top border-r" style="font: normal normal medium 17px/20px Roboto;">
                    Narration
                  </td>
                    <td class="px-4 py-3 align-top">
                    <div *ngIf="!isEditing" style="font: normal normal normal 17px/20px Roboto; color: #878C94; white-space: pre-line;">
                      {{currentStoryboard?.Narration || 'N/A'}}
                    </div>
                    <textarea *ngIf="isEditing" [(ngModel)]="currentStoryboard.Narration" rows="5"
                      class="w-full px-3 py-2 border border-[#D3D1D1] rounded-[8px] bg-[#EEEEEE]"
                      style="font: normal normal normal 17px/20px Roboto; color: #878C94;"></textarea>
                  </td>
                    </tr>

                    <tr>
                         <td class="px-4 py-3 text-left font-medium text-[#111111] align-top border-r" style="font: normal normal medium 17px/20px Roboto;">
                    Recommendations
                  </td>
                     <td class="px-4 py-3 align-top">
                    <div *ngIf="!isEditing" style="font: normal normal normal 17px/20px Roboto; color: #878C94;">
                      <ul class="list-disc pl-4">
                        <li *ngFor="let rec of currentStoryboard?.On_screen_Recommendations">{{rec}}</li>
                      </ul>
                    </div>
                    <textarea *ngIf="isEditing" [(ngModel)]="recommendationsInput" rows="3"
                      class="w-full px-3 py-2 border border-[#D3D1D1] rounded-[8px] bg-[#EEEEEE]"
                      style="font: normal normal normal 17px/20px Roboto; color: #878C94;"></textarea>
                  </td>
                    </tr>

                    <tr>
                       <td class="px-4 py-3 text-left font-medium text-[#111111] align-top border-r" style="font: normal normal medium 17px/20px Roboto;">
                    Developer Notes
                  </td>
                     <td class="px-4 py-3 align-top">
                    <div *ngIf="!isEditing" style="font: normal normal normal 17px/20px Roboto; color: #878C94;">
                      {{currentStoryboard?.Developer_Notes || 'N/A'}}
                    </div>
                    <textarea *ngIf="isEditing" [(ngModel)]="currentStoryboard.Developer_Notes" rows="3"
                      class="w-full px-3 py-2 border border-[#D3D1D1] rounded-[8px] bg-[#EEEEEE]"
                      style="font: normal normal normal 17px/20px Roboto; color: #878C94;"></textarea>
                  </td>
                    </tr>
                  </tbody>
                </table>
              </div>

              <div
                class="px-4 py-3 bg-gray-50 border-t border-gray-200 flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 font-roboto">
               <div class="flex items-center space-x-2">
    <button *ngIf="!isEditing" (click)="toggleEditMode()"
      class="inline-flex items-center justify-center text-white bg-[#111111] hover:bg-black transition-colors"
      style="width: 137px; height: 44px; border-radius: 8px;" title="Edit storyboard">
      <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24"
        stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5"
          d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z" />
      </svg>
      <span style="font: normal normal bold 17px/20px Roboto; color: #FFFFFF;">Edit</span>
    </button>
    
    <button *ngIf="isEditing" (click)="toggleEditMode()"
      class="inline-flex items-center justify-center text-red-400 bg-red-900/30 hover:bg-red-900/50 border border-red-700/50 transition-colors"
      style="width: 137px; height: 44px; border-radius: 8px;" title="Cancel editing">
      <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-2" fill="none" viewBox="0 0 24 24"
        stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M6 18L18 6M6 6l12 12" />
      </svg>
      <span style="font: normal normal bold 17px/20px Roboto; color: #FFFFFF;">Cancel</span>
    </button>
    
    <button *ngIf="isEditing" (click)="saveEditing()" [disabled]="isSaving"
      class="inline-flex items-center justify-center text-white bg-green-600 hover:bg-green-500 border border-green-500 transition-colors disabled:opacity-50"
      style="width: 137px; height: 44px; border-radius: 8px;" title="Save changes">
      <svg *ngIf="isSaving" class="animate-spin h-4 w-4 mr-2 text-white" xmlns="http://www.w3.org/2000/svg"
        fill="none" viewBox="0 0 24 24">
        <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
        <path class="opacity-75" fill="currentColor"
          d="M4 12a8 8 0 018-8v4l3-3-3-3v4a8 8 0 100 16v-4l-3 3 3 3v-4a8 8 0 01-8-8z"></path>
      </svg>
      <svg *ngIf="!isSaving" xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-2" fill="none"
        viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M5 13l4 4L19 7" />
      </svg>
      <span style="font: normal normal bold 17px/20px Roboto; color: #FFFFFF;">Save</span>
    </button>
  </div>

  <div *ngIf="storyboards && storyboards.length > 0" class="flex items-center gap-1">
    <button (click)="prevStoryboard()" [disabled]="currentIndex === 0"
      class="flex items-center justify-center bg-white border border-gray-300 text-gray-600 hover:bg-gray-50 hover:text-[#588AFF] transition-colors disabled:opacity-40 disabled:cursor-not-allowed"
      style="width: 44px; height: 44px; border-radius: 8px;" title="Previous storyboard">
      <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
        <path fill-rule="evenodd"
          d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z"
          clip-rule="evenodd" />
      </svg>
    </button>

    <div class="flex items-center gap-1 mx-3 px-4 py-2 bg-gray-100 rounded-md">
      <span class="text-sm font-medium text-gray-700">{{currentIndex + 1}}</span>
      <span class="text-sm text-gray-500">of</span>
      <span class="text-sm font-medium text-gray-700">{{storyboards.length}}</span>
    </div>

    <button (click)="nextStoryboard()" [disabled]="currentIndex === storyboards.length - 1"
      class="flex items-center justify-center bg-white border border-gray-300 text-gray-600 hover:bg-gray-50 hover:text-[#588AFF] transition-colors disabled:opacity-40 disabled:cursor-not-allowed"
      style="width: 44px; height: 44px; border-radius: 8px;" title="Next storyboard">
      <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
        <path fill-rule="evenodd"
          d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z"
          clip-rule="evenodd" />
      </svg>
    </button>
  </div>
                <div class="flex items-center space-x-2">
                  <button (click)="toggleApplyMode()"
      class="inline-flex items-center justify-center text-white bg-[#111111] hover:bg-black transition-colors"
      style="width: 137px; height: 44px; border-radius: 8px;" title="AI Enhance">
      <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24"
        stroke="currentColor">
        <rect x="8" y="8" width="8" height="8" rx="1" stroke="currentColor" stroke-width="1.5" />
        <path stroke="currentColor" stroke-width="1.5" stroke-linecap="round"
          d="M4 10h2M4 14h2M18 10h2M18 14h2M10 4v2M14 4v2M10 18v2M14 18v2" />
      </svg>
      <span style="font: normal normal bold 17px/20px Roboto; color: #FFFFFF;">Prompt to edit</span>
    </button>

                    <button (click)="downloadStoryboard()" [disabled]="isDownloading"
      class="inline-flex items-center justify-center text-white bg-[#111111] hover:bg-black transition-colors"
      style="width: 137px; height: 44px; border-radius: 8px;" title="Download storyboard">
      <svg *ngIf="isDownloading" class="animate-spin h-5 w-5 mr-2 text-white"
        xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
        <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
        <path class="opacity-75" fill="currentColor"
          d="M4 12a8 8 0 018-8v4l3-3-3-3v4a8 8 0 100 16v-4l-3 3 3 3v-4a8 8 0 01-8-8z"></path>
      </svg>
      <svg *ngIf="!isDownloading" xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" fill="none"
        viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5"
          d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4" />
      </svg>
      <span style="font: normal normal bold 17px/20px Roboto; color: #FFFFFF;">Download</span>
    </button>
                </div>
              </div>

              <div *ngIf="showApplySection" class="px-4 py-3 bg-gray-100 border-t border-gray-200">
  <div class="flex flex-col sm:flex-row gap-4 items-start sm:items-center">
    <div class="w-full sm:w-auto">
      <label class="block text-[17px] leading-[20px] font-normal text-[#111111] mb-3">Apply Changes To </label>
      <div class="flex space-x-4">
       <div class="flex items-center">
  <input type="radio" id="apply-current" [(ngModel)]="applyOption" value="current"
    class="h-3 w-3 border-gray-300 focus:ring-gray-400 border-gray-300">
  <label for="apply-current" class="ml-2 block text-[17px] leading-[20px] font-normal text-[#111111]">Current Screen</label>
</div>

        <div class="flex items-center">
  <input type="radio" id="apply-all" [(ngModel)]="applyOption" value="all"
    class="h-3 w-3 border-gray-300 focus:ring-gray-400 border-gray-300">
  <label for="apply-all" class="ml-2 block text-[17px] leading-[20px] font-normal text-[#111111]">All Screens</label>
</div>
      </div>
    </div>

    <div class="w-full sm:flex-1 min-w-[200px]">
      <label class="block text-[17px] leading-[20px] font-normal text-[#111111] mb-3">Prompt to Edit</label>
      <textarea [(ngModel)]="modificationPrompt" rows="2" required
        class="w-full px-2.5 py-1.5 bg-[#EEEEEE] border border-[#D3D1D1] rounded-[8px] focus:ring-1 focus:ring-gray-400 focus:border-gray-400 min-h-[60px]"
        placeholder="Enter detailed instructions for the changes you want to apply..."
        style="font: normal normal normal 17px/20px Roboto; color: #878C94;"></textarea>
    </div>

    <div class="w-full sm:w-auto flex items-end">
      <button (click)="applyChanges()" [disabled]="!modificationPrompt || isApplying"
        class="inline-flex items-center justify-center text-white bg-[#111111] hover:bg-black transition-colors disabled:opacity-50"
        style="width: 137px; height: 42px; border-radius: 8px;">
        <svg *ngIf="isApplying" class="animate-spin h-4 w-4 mr-2 text-white" xmlns="http://www.w3.org/2000/svg"
          fill="none" viewBox="0 0 24 24">
          <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
          <path class="opacity-75" fill="currentColor"
            d="M4 12a8 8 0 018-8v4l3-3-3-3v4a8 8 0 100 16v-4l-3 3 3 3v-4a8 8 0 01-8-8z"></path>
        </svg>
        <span style="font: normal normal bold 17px/20px Roboto; color: #FFFFFF;">
          {{isApplying ? 'Applying...' : 'Apply Changes'}}
        </span>
      </button>
    </div>
  </div>
</div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div> -->

<!-- <div class="bg-white flex-shrink-0 h-full" style="width: 430px;">
  <div class="pl-[32px] pr-4 py-5">
    <div class="space-y-5">
      
      <div class="border border-[#D3D1D1] rounded-[6px] p-2 bg-[#EEEEEE]">
        <div class="flex items-center justify-between mb-2">
          <div class="flex items-center">
            <label class="block text-[14px] leading-[16px] font-normal text-[#111111]">Style Guide <span class="text-red-500">*</span></label>
            <div class="relative flex items-center ml-1">
              <div class="style-guide-tooltip-container">
                <svg class="w-3 h-3 text-gray-400 cursor-help" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                  <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-3a1 1 0 00-.867.5 1 1 0 11-1.731-1A3 3 0 0113 8a3.001 3.001 0 01-2 2.83V11a1 1 0 11-2 0v-1a1 1 0 011-1 1 1 0 100-2zm0 8a1 1 0 100-2 1 1 0 000 2z" clip-rule="evenodd"/>
                </svg>
                <div class="tooltip">Upload your style guide to ensure content follows your brand guidelines</div>
              </div>
            </div>
          </div>
        </div>

        <div *ngIf="styleGuideFileName; else noStyleGuide" class="flex items-center justify-between">
          <span class="text-[14px] leading-[16px] font-normal text-[#878C94] truncate max-w-[112px]" [title]="styleGuideFileName">{{ styleGuideFileName }}</span>
          <button type="button" (click)="triggerStyleGuideUpload()" [disabled]="isUploadingStyleGuide"
            class="ml-2 px-2 py-1 text-[14px] leading-[16px] font-normal text-[#111111] border border-[#D3D1D1] rounded-[6px] bg-white hover:bg-gray-50 transition-colors disabled:opacity-50">
            <span *ngIf="!isUploadingStyleGuide">Replace</span>
            <span *ngIf="isUploadingStyleGuide">Uploading...</span>
          </button>
        </div>

        <ng-template #noStyleGuide>
          <div class="flex justify-center">
            <button type="button" (click)="triggerStyleGuideUpload()" [disabled]="isUploadingStyleGuide"
              class="px-2 py-1 text-[14px] leading-[16px] font-normal text-[#111111] border border-[#D3D1D1] rounded-[6px] bg-white hover:bg-gray-50 transition-colors disabled:opacity-50">
              <span *ngIf="!isUploadingStyleGuide">Upload Style Guide</span>
              <span *ngIf="isUploadingStyleGuide">Uploading...</span>
            </button>
          </div>
        </ng-template>

        <input id="style-guide-upload" type="file" class="sr-only" (change)="handleStyleGuideUpload($event)" accept=".pdf" #styleGuideInput>
      </div>

      <div>
        <div class="flex items-start">
          <label class="block text-[14px] leading-[16px] font-normal text-[#111111] mb-2">Module <span class="text-red-500">*</span></label>
          <div class="relative flex items-center ml-1 mt-0.5">
            <div class="tooltip-container">
              <svg class="w-2.5 h-2.5 text-gray-400 cursor-help" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-3a1 1 0 00-.867.5 1 1 0 11-1.731-1A3 3 0 0113 8a3.001 3.001 0 01-2 2.83V11a1 1 0 11-2 0v-1a1 1 0 011-1 1 1 0 100-2zm0 8a1 1 0 100-2 1 1 0 000 2z" clip-rule="evenodd"/>
              </svg>
              <div class="tooltip left-tooltip">Select the module where the outline is stored</div>
            </div>
          </div>
        </div>
        <select [(ngModel)]="selectedModule" (change)="onModuleChange()"
          class="w-full px-2 py-1 bg-[#EEEEEE] border border-[#D3D1D1] rounded-[6px] focus:ring-1 focus:ring-gray-400 focus:border-gray-400 transition-colors"
          style="height: 47px; font: normal normal normal 14px/16px Roboto; color: #878C94;">
          <option value="">Select a module</option>
          <option *ngFor="let module of modules" [value]="module">{{module}}</option>
        </select>
      </div>

     <div>
  <div class="flex items-start">
    <label class="block text-[14px] leading-[16px] font-normal text-[#111111] mb-2">Outline <span class="text-red-500">*</span></label>
    <div class="relative flex items-center ml-1 mt-0.5">
      <div class="tooltip-container">
        <svg class="w-2.5 h-2.5 text-gray-400 cursor-help" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
          <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-3a1 1 0 00-.867.5 1 1 0 11-1.731-1A3 3 0 0113 8a3.001 3.001 0 01-2 2.83V11a1 1 0 11-2 0v-1a1 1 0 011-1 1 1 0 100-2zm0 8a1 1 0 100-2 1 1 0 000 2z" clip-rule="evenodd"/>
        </svg>
        <div class="tooltip left-tooltip">Select an existing outline or upload a new one</div>
      </div>
    </div>
  </div>
  <select [(ngModel)]="selectedOutline"
    class="w-full px-2 py-1 bg-[#EEEEEE] border border-[#D3D1D1] rounded-[6px] focus:ring-1 focus:ring-gray-400 focus:border-gray-400 transition-colors"
    style="height: 47px; font: normal normal normal 14px/16px Roboto; color: #878C94;">
    <option value="">Select an outline</option>
    <option *ngFor="let outline of availableOutlines" [value]="outline">{{outline}}</option>
  </select>

  <div class="relative flex items-center my-2">
    <div class="flex-grow border-t border-gray-300"></div>
    <span class="flex-shrink mx-2 text-xs text-gray-500">OR</span>
    <div class="flex-grow border-t border-gray-300"></div>
  </div>
</div>
      <div>
        <div class="flex items-start">
          <label class="block text-[14px] leading-[16px] font-normal text-[#111111] mb-2">Upload Outline</label>
          <div class="relative flex items-center ml-1 mt-0.5">
            <div class="tooltip-container">
              <svg class="w-2.5 h-2.5 text-gray-400 cursor-help" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-3a1 1 0 00-.867.5 1 1 0 11-1.731-1A3 3 0 0113 8a3.001 3.001 0 01-2 2.83V11a1 1 0 11-2 0v-1a1 1 0 011-1 1 1 0 100-2zm0 8a1 1 0 100-2 1 1 0 000 2z" clip-rule="evenodd"/>
              </svg>
              <div class="tooltip left-tooltip">If you don't have an outline, you can upload a file here</div>
            </div>
          </div>
        </div>
        
        <div class="flex items-center">
          <label for="file-upload" class="cursor-pointer flex-grow">
            <span class="inline-flex items-center justify-center rounded-[6px] text-white bg-[#111111] hover:bg-black transition-colors shadow-sm" style="width: 128px; height: 34px;">
              <svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3 mr-1.5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"/>
              </svg>
              <span class="text-[14px] leading-[16px] font-bold">Choose File</span>
            </span>
            <span class="ml-2" style="font: normal normal normal 14px/16px Roboto; color: #878C94;" *ngIf="!uploadedFileName">No file chosen</span>
            <span class="ml-2 text-xs text-green-400 font-medium" *ngIf="uploadedFileName">{{uploadedFileName}}</span>
          </label>
          <input id="file-upload" type="file" class="sr-only" (change)="handleFileUpload($event)" accept=".doc,.docx,.pdf,.txt">
          <button *ngIf="uploadedFileName" (click)="clearFileUpload()" type="button" class="ml-1 p-1 text-gray-500 hover:text-red-400 transition-colors">✕</button>
        </div>
        
        <p class="mb-2 mt-2" style="font: normal normal normal 14px/16px Roboto; color: #878C94;">Supports: DOC & DOCX Only</p>

        <button *ngIf="uploadedFileName" [disabled]="isUploading" (click)="uploadOutline()" class="mt-2 flex justify-center items-center text-white bg-[#111111] hover:bg-black transition-colors disabled:opacity-50 w-full" style="height: 34px; border-radius: 6px;">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3 mr-1.5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"/>
          </svg>
          <span class="text-[14px] leading-[16px] font-bold">{{isUploading ? 'Processing...' : 'Upload & Process'}}</span>
        </button>
      </div>

      <div>
        <div class="flex items-start">
          <label class="block text-[14px] leading-[16px] font-normal text-[#111111] mb-2">Bloom's Level <span class="text-red-500">*</span></label>
          <div class="relative flex items-center ml-1 mt-0.5">
            <div class="tooltip-container">
              <svg class="w-2.5 h-2.5 text-gray-400 cursor-help" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-3a1 1 0 00-.867.5 1 1 0 11-1.731-1A3 3 0 0113 8a3.001 3.001 0 01-2 2.83V11a1 1 0 11-2 0v-1a1 1 0 011-1 1 1 0 100-2zm0 8a1 1 0 100-2 1 1 0 000 2z" clip-rule="evenodd"/>
              </svg>
              <div class="tooltip left-tooltip">Select the complexity level based on Bloom's Taxonomy</div>
            </div>
          </div>
        </div>
        <select [(ngModel)]="bloomsLevel"
          class="w-full px-2 py-1 bg-[#EEEEEE] border border-[#D3D1D1] rounded-[6px] focus:ring-1 focus:ring-gray-400 focus:border-gray-400 transition-colors"
          style="height: 47px; font: normal normal normal 14px/16px Roboto; color: #878C94;">
          <option value="">Select level</option>
          <option *ngFor="let level of bloomsLevels" [value]="level">{{level}}</option>
        </select>
      </div>

      <div>
        <div class="flex items-start">
          <label class="block text-[14px] leading-[16px] font-normal text-[#111111] mb-2">Context Prompt</label>
          <div class="relative flex items-center ml-1 mt-0.5">
            <div class="tooltip-container">
              <svg class="w-2.5 h-2.5 text-gray-400 cursor-help" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-3a1 1 0 00-.867.5 1 1 0 11-1.731-1A3 3 0 0113 8a3.001 3.001 0 01-2 2.83V11a1 1 0 11-2 0v-1a1 1 0 011-1 1 1 0 100-2zm0 8a1 1 0 100-2 1 1 0 000 2z" clip-rule="evenodd"/>
              </svg>
              <div class="tooltip left-tooltip text-xs leading-snug">
                <strong>Add context for storyboard generation. Examples:</strong><br>• Create a storyboard with limited on-screen text (OST)<br>• Create a storyboard with limited narration<br>• Create a storyboard including both OST and narration verbatim<br>• Create a non-audio storyboard for a level 2 course<br>• Create a storyboard for a scenario-based module<br>• Create a storyboard with simulations in both show-me and try-me modes<br>• Create a storyboard where all knowledge checks are scenario-based<br>• Create a storyboard in a conversational tone
              </div>
            </div>
          </div>
        </div>
        <textarea [(ngModel)]="contextPrompt" rows="3"
          class="w-full px-2 py-1 bg-[#EEEEEE] border border-[#D3D1D1] rounded-[6px] focus:ring-1 focus:ring-gray-400 focus:border-gray-400"
          placeholder="Enter any additional context or instructions..."
          style="height: 67px; font: normal normal normal 14px/16px Roboto; color: #878C94;"></textarea>
      </div>

      <div class="space-y-2">
        <div class="flex items-center">
          <input [(ngModel)]="isNASBA" id="nasba-checkbox" type="checkbox" class="h-3 w-3 border-[#D3D1D1] rounded accent-purple-500">
          <label for="nasba-checkbox" class="ml-2 block text-[14px] leading-[16px] font-normal text-[#111111]">NASBA Compliant</label>
          <div class="relative flex items-center ml-1">
            <div class="tooltip-container">
              <svg class="w-2.5 h-2.5 text-gray-400 cursor-help" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-3a1 1 0 00-.867.5 1 1 0 11-1.731-1A3 3 0 0113 8a3.001 3.001 0 01-2 2.83V11a1 1 0 11-2 0v-1a1 1 0 011-1 1 1 0 100-2zm0 8a1 1 0 100-2 1 1 0 000 2z" clip-rule="evenodd"/>
              </svg>
              <div class="tooltip left-tooltip">Ensure content meets National Association of State Boards of Accountancy standards</div>
            </div>
          </div>
        </div>
        <div class="flex items-center">
          <input [(ngModel)]="isUKEnglish" id="uk-english-checkbox" type="checkbox" class="h-3 w-3 border-[#D3D1D1] rounded accent-purple-500">
          <label for="uk-english-checkbox" class="ml-2 block text-[14px] leading-[16px] font-normal text-[#111111]">UK English</label>
          <div class="relative flex items-center ml-1">
            <div class="tooltip-container">
              <svg class="w-2.5 h-2.5 text-gray-400 cursor-help" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-3a1 1 0 00-.867.5 1 1 0 11-1.731-1A3 3 0 0113 8a3.001 3.001 0 01-2 2.83V11a1 1 0 11-2 0v-1a1 1 0 011-1 1 1 0 100-2zm0 8a1 1 0 100-2 1 1 0 000 2z" clip-rule="evenodd"/>
              </svg>
              <div class="tooltip left-tooltip">Use UK English spelling and terminology (default is US English)</div>
            </div>
          </div>
        </div>
      </div>

      <div class="pt-2">
        <button (click)="submitStoryboard()" [disabled]="!canGenerate()" class="flex justify-center items-center text-white disabled:opacity-50 transition-colors w-full"
          style="height: 35px; border-radius: 6px; background: linear-gradient(93deg, #588AFF 0%, #8E0ED8 100%);">
          <span class="text-[14px] leading-[16px] font-bold">{{isLoading ? 'Generating...' : 'Generate Storyboard'}}</span>
        </button>
      </div>
      
    </div>
  </div>
</div> -->
<!-- sidebar -->

<!-- rem sidebar -->
<!-- <div class="bg-white flex-shrink-0 h-full w-[26.875rem]">
      <div class="pl-[2rem] pr-[1rem] py-[1.25rem]">
        <div class="space-y-[1.25rem]">
          
          <div class="border border-[#D3D1D1] rounded-[0.375rem] p-[0.5rem] bg-[#EEEEEE]">
            <div class="flex items-center justify-between mb-[0.5rem]">
              <div class="flex items-center">
                <label class="block text-[0.875rem] leading-[1rem] font-normal text-[#111111]">Style Guide <span class="text-red-500">*</span></label>
                <div class="relative flex items-center ml-[0.25rem]">
                  <div class="style-guide-tooltip-container">
                    <svg class="w-[0.75rem] h-[0.75rem] text-gray-400 cursor-help" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                      <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-3a1 1 0 00-.867.5 1 1 0 11-1.731-1A3 3 0 0113 8a3.001 3.001 0 01-2 2.83V11a1 1 0 11-2 0v-1a1 1 0 011-1 1 1 0 100-2zm0 8a1 1 0 100-2 1 1 0 000 2z" clip-rule="evenodd"/>
                    </svg>
                    <div class="tooltip">Upload your style guide to ensure content follows your brand guidelines</div>
                  </div>
                </div>
              </div>
            </div>

            <div *ngIf="styleGuideFileName; else noStyleGuide" class="flex items-center justify-between">
              <span class="text-[0.875rem] leading-[1rem] font-normal text-[#878C94] truncate max-w-[7rem]" [title]="styleGuideFileName">{{ styleGuideFileName }}</span>
              <button type="button" (click)="triggerStyleGuideUpload()" [disabled]="isUploadingStyleGuide"
                class="ml-[0.5rem] px-[0.5rem] py-[0.25rem] text-[0.875rem] leading-[1rem] font-normal text-[#111111] border border-[#D3D1D1] rounded-[0.375rem] bg-white hover:bg-gray-50 transition-colors disabled:opacity-50">
                <span *ngIf="!isUploadingStyleGuide">Replace</span>
                <span *ngIf="isUploadingStyleGuide">Uploading...</span>
              </button>
            </div>

            <ng-template #noStyleGuide>
              <div class="flex justify-center">
                <button type="button" (click)="triggerStyleGuideUpload()" [disabled]="isUploadingStyleGuide"
                  class="px-[0.5rem] py-[0.25rem] text-[0.875rem] leading-[1rem] font-normal text-[#111111] border border-[#D3D1D1] rounded-[0.375rem] bg-white hover:bg-gray-50 transition-colors disabled:opacity-50">
                  <span *ngIf="!isUploadingStyleGuide">Upload Style Guide</span>
                  <span *ngIf="isUploadingStyleGuide">Uploading...</span>
                </button>
              </div>
            </ng-template>

            <input id="style-guide-upload" type="file" class="sr-only" (change)="handleStyleGuideUpload($event)" accept=".pdf" #styleGuideInput>
          </div>

          <div>
            <div class="flex items-start">
              <label class="block text-[0.875rem] leading-[1rem] font-normal text-[#111111] mb-[0.5rem]">Module <span class="text-red-500">*</span></label>
              <div class="relative flex items-center ml-[0.25rem] mt-[0.125rem]">
                <div class="tooltip-container">
                  <svg class="w-[0.625rem] h-[0.625rem] text-gray-400 cursor-help" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                    <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-3a1 1 0 00-.867.5 1 1 0 11-1.731-1A3 3 0 0113 8a3.001 3.001 0 01-2 2.83V11a1 1 0 11-2 0v-1a1 1 0 011-1 1 1 0 100-2zm0 8a1 1 0 100-2 1 1 0 000 2z" clip-rule="evenodd"/>
                  </svg>
                  <div class="tooltip left-tooltip">Select the module where the outline is stored</div>
                </div>
              </div>
            </div>
            <select [(ngModel)]="selectedModule" (change)="onModuleChange()"
              class="w-full px-[0.5rem] py-[0.25rem] bg-[#EEEEEE] border border-[#D3D1D1] rounded-[0.375rem] focus:ring-1 focus:ring-gray-400 focus:border-gray-400 transition-colors"
              style="height: 2.9375rem; font: normal normal normal 0.875rem/1rem Roboto; color: #878C94;">
              <option value="">Select a module</option>
              <option *ngFor="let module of modules" [value]="module">{{module}}</option>
            </select>
          </div>

          <div>
            <div class="flex items-start">
              <label class="block text-[0.875rem] leading-[1rem] font-normal text-[#111111] mb-[0.5rem]">Outline <span class="text-red-500">*</span></label>
              <div class="relative flex items-center ml-[0.25rem] mt-[0.125rem]">
                <div class="tooltip-container">
                  <svg class="w-[0.625rem] h-[0.625rem] text-gray-400 cursor-help" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                    <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-3a1 1 0 00-.867.5 1 1 0 11-1.731-1A3 3 0 0113 8a3.001 3.001 0 01-2 2.83V11a1 1 0 11-2 0v-1a1 1 0 011-1 1 1 0 100-2zm0 8a1 1 0 100-2 1 1 0 000 2z" clip-rule="evenodd"/>
                  </svg>
                  <div class="tooltip left-tooltip">Select an existing outline or upload a new one</div>
                </div>
              </div>
            </div>
            <select [(ngModel)]="selectedOutline"
              class="w-full px-[0.5rem] py-[0.25rem] bg-[#EEEEEE] border border-[#D3D1D1] rounded-[0.375rem] focus:ring-1 focus:ring-gray-400 focus:border-gray-400 transition-colors"
              style="height: 2.9375rem; font: normal normal normal 0.875rem/1rem Roboto; color: #878C94;">
              <option value="">Select an outline</option>
              <option *ngFor="let outline of availableOutlines" [value]="outline">{{outline}}</option>
            </select>

            <div class="relative flex items-center my-[0.5rem]">
              <div class="flex-grow border-t border-gray-300"></div>
              <span class="flex-shrink mx-[0.5rem] text-xs text-gray-500">OR</span>
              <div class="flex-grow border-t border-gray-300"></div>
            </div>
          </div>

          <div>
            <div class="flex items-start">
              <label class="block text-[0.875rem] leading-[1rem] font-normal text-[#111111] mb-[0.5rem]">Upload Outline</label>
              <div class="relative flex items-center ml-[0.25rem] mt-[0.125rem]">
                <div class="tooltip-container">
                  <svg class="w-[0.625rem] h-[0.625rem] text-gray-400 cursor-help" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                    <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-3a1 1 0 00-.867.5 1 1 0 11-1.731-1A3 3 0 0113 8a3.001 3.001 0 01-2 2.83V11a1 1 0 11-2 0v-1a1 1 0 011-1 1 1 0 100-2zm0 8a1 1 0 100-2 1 1 0 000 2z" clip-rule="evenodd"/>
                  </svg>
                  <div class="tooltip left-tooltip">If you don't have an outline, you can upload a file here</div>
                </div>
              </div>
            </div>
            
            <div class="flex items-center">
              <label for="file-upload" class="cursor-pointer flex-grow">
                <span class="inline-flex items-center justify-center rounded-[0.375rem] text-white bg-[#111111] hover:bg-black transition-colors shadow-sm" style="width: 8rem; height: 2.125rem;">
                  <svg xmlns="http://www.w3.org/2000/svg" class="h-[0.75rem] w-[0.75rem] mr-[0.375rem]" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"/>
                  </svg>
                  <span class="text-[0.875rem] leading-[1rem] font-bold">Choose File</span>
                </span>
                <span class="ml-[0.5rem]" style="font: normal normal normal 0.875rem/1rem Roboto; color: #878C94;" *ngIf="!uploadedFileName">No file chosen</span>
                <span class="ml-[0.5rem] text-xs text-green-400 font-medium" *ngIf="uploadedFileName">{{uploadedFileName}}</span>
              </label>
              <input id="file-upload" type="file" class="sr-only" (change)="handleFileUpload($event)" accept=".doc,.docx,.pdf,.txt">
              <button *ngIf="uploadedFileName" (click)="clearFileUpload()" type="button" class="ml-[0.25rem] p-[0.25rem] text-gray-500 hover:text-red-400 transition-colors">✕</button>
            </div>
            
            <p class="mb-[0.5rem] mt-[0.5rem]" style="font: normal normal normal 0.875rem/1rem Roboto; color: #878C94;">Supports: DOC & DOCX Only</p>

            <button *ngIf="uploadedFileName" [disabled]="isUploading" (click)="uploadOutline()" class="mt-[0.5rem] flex justify-center items-center text-white bg-[#111111] hover:bg-black transition-colors disabled:opacity-50 w-full" style="height: 2.125rem; border-radius: 0.375rem;">
              <svg xmlns="http://www.w3.org/2000/svg" class="h-[0.75rem] w-[0.75rem] mr-[0.375rem]" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"/>
              </svg>
              <span class="text-[0.875rem] leading-[1rem] font-bold">{{isUploading ? 'Processing...' : 'Upload & Process'}}</span>
            </button>
          </div>

          <div>
            <div class="flex items-start">
              <label class="block text-[0.875rem] leading-[1rem] font-normal text-[#111111] mb-[0.5rem]">Bloom's Level <span class="text-red-500">*</span></label>
              <div class="relative flex items-center ml-[0.25rem] mt-[0.125rem]">
                <div class="tooltip-container">
                  <svg class="w-[0.625rem] h-[0.625rem] text-gray-400 cursor-help" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                    <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-3a1 1 0 00-.867.5 1 1 0 11-1.731-1A3 3 0 0113 8a3.001 3.001 0 01-2 2.83V11a1 1 0 11-2 0v-1a1 1 0 011-1 1 1 0 100-2zm0 8a1 1 0 100-2 1 1 0 000 2z" clip-rule="evenodd"/>
                  </svg>
                  <div class="tooltip left-tooltip">Select the complexity level based on Bloom's Taxonomy</div>
                </div>
              </div>
            </div>
            <select [(ngModel)]="bloomsLevel"
              class="w-full px-[0.5rem] py-[0.25rem] bg-[#EEEEEE] border border-[#D3D1D1] rounded-[0.375rem] focus:ring-1 focus:ring-gray-400 focus:border-gray-400 transition-colors"
              style="height: 2.9375rem; font: normal normal normal 0.875rem/1rem Roboto; color: #878C94;">
              <option value="">Select level</option>
              <option *ngFor="let level of bloomsLevels" [value]="level">{{level}}</option>
            </select>
          </div>

          <div>
            <div class="flex items-start">
              <label class="block text-[0.875rem] leading-[1rem] font-normal text-[#111111] mb-[0.5rem]">Context Prompt</label>
              <div class="relative flex items-center ml-[0.25rem] mt-[0.125rem]">
                <div class="tooltip-container">
                  <svg class="w-[0.625rem] h-[0.625rem] text-gray-400 cursor-help" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                    <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-3a1 1 0 00-.867.5 1 1 0 11-1.731-1A3 3 0 0113 8a3.001 3.001 0 01-2 2.83V11a1 1 0 11-2 0v-1a1 1 0 011-1 1 1 0 100-2zm0 8a1 1 0 100-2 1 1 0 000 2z" clip-rule="evenodd"/>
                  </svg>
                  <div class="tooltip left-tooltip text-xs leading-snug">
                    <strong>Add context for storyboard generation. Examples:</strong><br>• Create a storyboard with limited on-screen text (OST)<br>• Create a storyboard with limited narration<br>• Create a storyboard including both OST and narration verbatim<br>• Create a non-audio storyboard for a level 2 course<br>• Create a storyboard for a scenario-based module<br>• Create a storyboard with simulations in both show-me and try-me modes<br>• Create a storyboard where all knowledge checks are scenario-based<br>• Create a storyboard in a conversational tone
                  </div>
                </div>
              </div>
            </div>
            <textarea [(ngModel)]="contextPrompt" rows="3"
              class="w-full px-[0.5rem] py-[0.25rem] bg-[#EEEEEE] border border-[#D3D1D1] rounded-[0.375rem] focus:ring-1 focus:ring-gray-400 focus:border-gray-400"
              placeholder="Enter any additional context or instructions..."
              style="height: 4.1875rem; font: normal normal normal 0.875rem/1rem Roboto; color: #878C94;"></textarea>
          </div>

          <div class="space-y-[0.5rem]">
            <div class="flex items-center">
              <input [(ngModel)]="isNASBA" id="nasba-checkbox" type="checkbox" class="h-[0.75rem] w-[0.75rem] border-[#D3D1D1] rounded accent-purple-500">
              <label for="nasba-checkbox" class="ml-[0.5rem] block text-[0.875rem] leading-[1rem] font-normal text-[#111111]">NASBA Compliant</label>
              <div class="relative flex items-center ml-[0.25rem]">
                <div class="tooltip-container">
                  <svg class="w-[0.625rem] h-[0.625rem] text-gray-400 cursor-help" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                    <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-3a1 1 0 00-.867.5 1 1 0 11-1.731-1A3 3 0 0113 8a3.001 3.001 0 01-2 2.83V11a1 1 0 11-2 0v-1a1 1 0 011-1 1 1 0 100-2zm0 8a1 1 0 100-2 1 1 0 000 2z" clip-rule="evenodd"/>
                  </svg>
                  <div class="tooltip left-tooltip">Ensure content meets National Association of State Boards of Accountancy standards</div>
                </div>
              </div>
            </div>
            <div class="flex items-center">
              <input [(ngModel)]="isUKEnglish" id="uk-english-checkbox" type="checkbox" class="h-[0.75rem] w-[0.75rem] border-[#D3D1D1] rounded accent-purple-500">
              <label for="uk-english-checkbox" class="ml-[0.5rem] block text-[0.875rem] leading-[1rem] font-normal text-[#111111]">UK English</label>
              <div class="relative flex items-center ml-[0.25rem]">
                <div class="tooltip-container">
                  <svg class="w-[0.625rem] h-[0.625rem] text-gray-400 cursor-help" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                    <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-3a1 1 0 00-.867.5 1 1 0 11-1.731-1A3 3 0 0113 8a3.001 3.001 0 01-2 2.83V11a1 1 0 11-2 0v-1a1 1 0 011-1 1 1 0 100-2zm0 8a1 1 0 100-2 1 1 0 000 2z" clip-rule="evenodd"/>
                  </svg>
                  <div class="tooltip left-tooltip">Use UK English spelling and terminology (default is US English)</div>
                </div>
              </div>
            </div>
          </div>

          <div class="pt-[0.5rem]">
            <button (click)="submitStoryboard()" [disabled]="!canGenerate()" class="flex justify-center items-center text-white disabled:opacity-50 transition-colors w-full"
              style="height: 2.1875rem; border-radius: 0.375rem; background: linear-gradient(93deg, #588AFF 0%, #8E0ED8 100%);">
              <span class="text-[0.875rem] leading-[1rem] font-bold">{{isLoading ? 'Generating...' : 'Generate Storyboard'}}</span>
            </button>
          </div>
          
        </div>
      </div>
    </div> -->



<!-- <div class="mb-4 lg:mb-[1rem]">
            <div class="flex items-start">
              <label
                class="block text-sm lg:text-[0.875rem] leading-[1rem] font-normal text-[#111111] mb-2 lg:mb-[0.5rem]">
                Style Guide <span class="text-red-500">*</span>
              </label>
              <div class="relative flex items-center ml-1 lg:ml-[0.25rem] mt-0.5 lg:mt-[0.125rem]">
                <div class="style-guide-tooltip-container">
                  <svg class="w-2.5 h-2.5 lg:w-[0.625rem] lg:h-[0.625rem] text-gray-400 cursor-help" fill="currentColor"
                    viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                    <path fill-rule="evenodd"
                      d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-3a1 1 0 00-.867.5 1 1 0 11-1.731-1A3 3 0 0113 8a3.001 3.001 0 01-2 2.83V11a1 1 0 11-2 0v-1a1 1 0 011-1 1 1 0 100-2zm0 8a1 1 0 100-2 1 1 0 000 2z"
                      clip-rule="evenodd" />
                  </svg>
                  <div class="tooltip">Upload the client style guide to ensure the content aligns with the client’s
                    brand guidelines.</div>
                </div>
              </div>
            </div>

            <div *ngIf="styleGuideFileName; else noStyleGuide" class="flex items-center justify-between">
              <span class="text-sm lg:text-[0.875rem] leading-[1rem] font-normal text-[#111111] truncate max-w-[10rem]"
                [title]="styleGuideFileName">
                {{ styleGuideFileName }}
              </span>
              <button type="button" (click)="triggerStyleGuideUpload()" [disabled]="isUploadingStyleGuide"
                class="ml-2 px-3 py-1.5 text-sm lg:text-[0.875rem] leading-[1rem] font-bold text-white bg-[#111111] rounded-md lg:rounded-[0.375rem] hover:bg-black transition-colors disabled:opacity-50">
                <span *ngIf="!isUploadingStyleGuide">Replace</span>
                <span *ngIf="isUploadingStyleGuide">Uploading...</span>
              </button>
            </div>

            <ng-template #noStyleGuide>
              <div class="flex justify-start">
                <button type="button" (click)="triggerStyleGuideUpload()" [disabled]="isUploadingStyleGuide"
                  class="flex items-center justify-center px-5 text-sm lg:text-[0.875rem] leading-[1rem] font-bold text-white bg-[#111111] rounded-md lg:rounded-[0.375rem] hover:bg-black transition-colors disabled:opacity-50"
                  style="height: 2.125rem;">
                  <svg xmlns="http://www.w3.org/2000/svg"
                    class="h-3 w-3 lg:h-[0.75rem] lg:w-[0.75rem] mr-1.5 lg:mr-[0.375rem]" fill="none"
                    viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                      d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12" />
                  </svg>
                  <span *ngIf="!isUploadingStyleGuide">Upload</span>
                  <span *ngIf="isUploadingStyleGuide">Uploading...</span>
                </button>
              </div>
            </ng-template>

            <input id="style-guide-upload" type="file" class="sr-only" (change)="handleStyleGuideUpload($event)"
              accept=".pdf" #styleGuideInput>
          </div> -->


<!-- <div>
            <div class="flex items-start">
              <label class="block text-sm lg:text-[0.875rem] leading-[1rem] font-normal text-[#111111] mb-2 lg:mb-[0.5rem]">Outline <span class="text-red-500">*</span></label>
              <div class="relative flex items-center ml-1 lg:ml-[0.25rem] mt-0.5 lg:mt-[0.125rem]">
                <div class="tooltip-container">
                  <svg class="w-2.5 h-2.5 lg:w-[0.625rem] lg:h-[0.625rem] text-gray-400 cursor-help" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                    <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-3a1 1 0 00-.867.5 1 1 0 11-1.731-1A3 3 0 0113 8a3.001 3.001 0 01-2 2.83V11a1 1 0 11-2 0v-1a1 1 0 011-1 1 1 0 100-2zm0 8a1 1 0 100-2 1 1 0 000 2z" clip-rule="evenodd"/>
                  </svg>
                  <div class="tooltip left-tooltip">Choose an existing outline or upload a new one.</div>
                </div>
              </div>
            </div>
            <select [(ngModel)]="selectedOutline"
              class="w-full px-2 lg:px-[0.5rem] py-1 lg:py-[0.25rem] bg-[#EEEEEE] border border-[#D3D1D1] rounded-md lg:rounded-[0.375rem] focus:ring-1 focus:ring-gray-400 focus:border-gray-400 transition-colors"
              style="height: 2.75rem; font: normal normal normal 14px/16px Roboto; color: #111111;">
              <option value="">Select an outline</option>
              <option *ngFor="let outline of availableOutlines" [value]="outline">{{outline}}</option>
            </select>

            <div class="relative flex items-center my-2 lg:my-[0.5rem]">
              <div class="flex-grow border-t border-gray-300"></div>
              <span class="flex-shrink mx-2 lg:mx-[0.5rem] text-xs text-gray-500">OR</span>
              <div class="flex-grow border-t border-gray-300"></div>
            </div>
          </div> -->
<!-- Outline Selection damodar -->


<!--           
          <div>
            
            <div class="flex items-start">
              <label
                class="block text-sm lg:text-[0.875rem] leading-[1rem] font-normal text-[#111111] mb-2 lg:mb-[0.5rem]">Upload
                Outline</label>
              <div class="relative flex items-center ml-1 lg:ml-[0.25rem] mt-0.5 lg:mt-[0.125rem]">
                <div class="tooltip-container">
                  <svg class="w-2.5 h-2.5 lg:w-[0.625rem] lg:h-[0.625rem] text-gray-400 cursor-help" fill="currentColor"
                    viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                    <path fill-rule="evenodd"
                      d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-3a1 1 0 00-.867.5 1 1 0 11-1.731-1A3 3 0 0113 8a3.001 3.001 0 01-2 2.83V11a1 1 0 11-2 0v-1a1 1 0 011-1 1 1 0 100-2zm0 8a1 1 0 100-2 1 1 0 000 2z"
                      clip-rule="evenodd" />
                  </svg>
                  <div class="tooltip left-tooltip">If you don't have an outline, you can upload a file here</div>
                </div>
              </div>
            </div>

            <div class="flex flex-col sm:flex-row sm:items-center gap-2">

              <label for="file-upload" class="cursor-pointer">
                <span
                  class="inline-flex items-center justify-center rounded-md lg:rounded-[0.375rem] text-white bg-[#111111] hover:bg-black transition-colors shadow-sm"
                  style="width: 8rem; height: 2.125rem;">
                  <svg xmlns="http://www.w3.org/2000/svg"
                    class="h-3 w-3 lg:h-[0.75rem] lg:w-[0.75rem] mr-1.5 lg:mr-[0.375rem]" fill="none"
                    viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                      d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12" />
                  </svg>
                  <span class="text-sm lg:text-[0.875rem] leading-[1rem] font-bold">Choose File</span>
                </span>
              </label>
              <div class="flex items-center flex-1">
                <span class="ml-0 sm:ml-2 text-sm lg:text-[0.875rem]" *ngIf="!uploadedFileName"
                  style="font: normal normal normal 14px/16px Roboto; color: #111111;">No file chosen</span>
                <span class="ml-0 sm:ml-2 text-xs text-[#111111] font-medium"
                  *ngIf="uploadedFileName">{{uploadedFileName}}</span>
                <button *ngIf="uploadedFileName" (click)="clearFileUpload()" type="button"
                  class="ml-1 p-1 text-gray-500 hover:text-red-400 transition-colors">✕</button>
              </div>

              <input id="file-upload" type="file" class="sr-only" (change)="handleFileUpload($event)"
                accept=".doc,.docx">
            </div>

            <p class="mb-2 lg:mb-[0.5rem] mt-2 lg:mt-[0.5rem] text-sm lg:text-[0.875rem]"
              style="font: normal normal normal 14px/16px Roboto; color: #111111;">Supports: DOC & DOCX Only</p>

            <button *ngIf="uploadedFileName" [disabled]="isUploading" (click)="uploadOutline()"
              class="mt-2 lg:mt-[0.5rem] flex justify-center items-center text-white bg-[#111111] hover:bg-black transition-colors disabled:opacity-50 w-full"
              style="height: 2.125rem; border-radius: 0.375rem;">
              <svg xmlns="http://www.w3.org/2000/svg"
                class="h-3 w-3 lg:h-[0.75rem] lg:w-[0.75rem] mr-1.5 lg:mr-[0.375rem]" fill="none" viewBox="0 0 24 24"
                stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                  d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12" />
              </svg>
              <span class="text-sm lg:text-[0.875rem] leading-[1rem] font-bold">{{isUploading ? 'Processing...' :
                'Upload & Process'}}</span>
            </button>
          </div> -->


<!-- Damodar Outline Information Section (NEW) -->
<!-- Damodar Outline Information Section (NEW) -->
<!-- <div *ngIf="outlineMetadata" class="mb-4">
<h3 class="block text-sm lg:text-[0.875rem] leading-[1rem] font-normal text-[#111111] mb-2 lg:mb-[0.5rem]">Outline Information</h3>
<div class="px-2 lg:px-[0.5rem] py-1 lg:py-[0.25rem] bg-[#EEEEEE] border border-[#D3D1D1] rounded-md lg:rounded-[0.375rem]">
<div *ngIf="outlineUserPrompt" class="mb-2">
<span class="text-sm lg:text-[0.875rem] font-normal text-[#111111]">Original Prompt: </span>
<span class="text-sm lg:text-[0.875rem] text-[#111111]">{{ outlineUserPrompt }}</span>
</div>
<div>
<span class="text-sm lg:text-[0.875rem] font-normal text-[#111111]">File: </span>
<span class="text-sm lg:text-[0.875rem] text-[#111111]">{{ selectedOutline }}</span>
</div>
</div>
</div> -->

<!-- <button (click)="submitStoryboard()" [disabled]="!canGenerate()" class="flex justify-center items-center text-white disabled:opacity-50 transition-colors w-full"
              style="height: 2.5rem; border-radius: 0.375rem; background: linear-gradient(93deg, #588AFF 0%, #8E0ED8 100%);">
              <span class="text-sm lg:text-[0.875rem] leading-[1rem] font-bold">{{isLoading ? 'Generating...' : 'Generate Storyboard'}}</span>
            </button> -->

<!-- <div class="flex items-center space-x-[0.5rem] order-2 sm:order-1">
              <button *ngIf="!isEditing" (click)="toggleEditMode()"
                class="inline-flex items-center justify-center text-white bg-[#111111] hover:bg-black transition-colors"
                style="width: 6.875rem; height: 2.1875rem; border-radius: 0.375rem;" title="Edit storyboard">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-[1rem] w-[1rem] mr-[0.375rem]" fill="none" viewBox="0 0 24 24"
                  stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5"
                    d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z" />
                </svg>
                <span style="font: normal normal bold 0.875rem/1rem Roboto; color: #FFFFFF;">Edit</span>
              </button>
              
              <button *ngIf="isEditing" (click)="toggleEditMode()"
                class="inline-flex items-center justify-center text-red-400 bg-red-900/30 hover:bg-red-900/50 border border-red-700/50 transition-colors"
                style="width: 6.875rem; height: 2.1875rem; border-radius: 0.375rem;" title="Cancel editing">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-[0.75rem] w-[0.75rem] mr-[0.375rem]" fill="none" viewBox="0 0 24 24"
                  stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M6 18L18 6M6 6l12 12" />
                </svg>
                <span style="font: normal normal bold 0.875rem/1rem Roboto; color: #FFFFFF;">Cancel</span>
              </button>
              
              <button *ngIf="isEditing" (click)="saveEditing()" [disabled]="isSaving"
                class="inline-flex items-center justify-center text-white bg-green-600 hover:bg-green-500 border border-green-500 transition-colors disabled:opacity-50"
                style="width: 6.875rem; height: 2.1875rem; border-radius: 0.375rem;" title="Save changes">
                <svg *ngIf="isSaving" class="animate-spin h-[0.75rem] w-[0.75rem] mr-[0.375rem] text-white" xmlns="http://www.w3.org/2000/svg"
                  fill="none" viewBox="0 0 24 24">
                  <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                  <path class="opacity-75" fill="currentColor"
                    d="M4 12a8 8 0 018-8v4l3-3-3-3v4a8 8 0 100 16v-4l-3 3 3 3v-4a8 8 0 01-8-8z"></path>
                </svg>
                <svg *ngIf="!isSaving" xmlns="http://www.w3.org/2000/svg" class="h-[0.75rem] w-[0.75rem] mr-[0.375rem]" fill="none"
                  viewBox="0 0 24 24" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M5 13l4 4L19 7" />
                </svg>
                <span style="font: normal normal bold 0.875rem/1rem Roboto; color: #FFFFFF;">Save</span>
              </button>
            </div> -->

            

<!-- <button (click)="toggleApplyMode()"
                class="inline-flex items-center justify-center text-white bg-[#111111] hover:bg-black transition-colors"
                style="width: 6.875rem; height: 2.1875rem; border-radius: 0.375rem;" title="AI Enhance">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-[1rem] w-[1rem] mr-[0.375rem]" fill="none" viewBox="0 0 24 24"
                  stroke="currentColor">
                  <rect x="8" y="8" width="8" height="8" rx="1" stroke="currentColor" stroke-width="1.5" />
                  <path stroke="currentColor" stroke-width="1.5" stroke-linecap="round"
                    d="M4 10h2M4 14h2M18 10h2M18 14h2M10 4v2M14 4v2M10 18v2M14 18v2" />
                </svg>
                <span style="font: normal normal bold 0.875rem/1rem Roboto; color: #FFFFFF;">Prompt to edit</span>
              </button> -->

<!-- <button (click)="downloadStoryboard()" [disabled]="isDownloading"
                class="inline-flex items-center justify-center text-white bg-[#111111] hover:bg-black transition-colors"
                style="width: 6.875rem; height: 2.1875rem; border-radius: 0.375rem;" title="Download storyboard">
                <svg *ngIf="isDownloading" class="animate-spin h-[1rem] w-[1rem] mr-[0.375rem] text-white"
                  xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                  <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                   <path class="opacity-75" fill="currentColor"
                    d="M4 12a8 8 0 018-8v4l3-3-3-3v4a8 8 0 100 16v-4l-3 3 3 3v-4a8 8 0 01-8-8z"></path>
                </svg>
                <svg *ngIf="!isDownloading" xmlns="http://www.w3.org/2000/svg" class="h-[1rem] w-[1rem] mr-[0.375rem]" fill="none"
                  viewBox="0 0 24 24" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5"
                    d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4" />
                </svg>
                <span style="font: normal normal bold 0.875rem/1rem Roboto; color: #FFFFFF;">Download</span>
              </button> -->






<div class="min-h-screen bg-[#EEEEEE] flex flex-col">
  <app-navbar [client]="client" [project]="project"></app-navbar>

  <div class="flex flex-1 overflow-hidden">


    <div class="bg-white flex-shrink-0 w-full lg:w-[26.875rem] h-auto lg:h-[44rem] overflow-y-auto">

      <div class="pl-4 pr-3 py-5 lg:pl-[2rem] lg:pr-[1rem] lg:py-[1.25rem]">
        <div class="space-y-5 lg:space-y-[1.25rem]">

          <div class="mb-4 lg:mb-[1rem]">
            <div class="flex items-start">
              <label
                class="block text-sm lg:text-[0.875rem] leading-[1rem] font-normal text-[#111111] mb-2 lg:mb-[0.5rem]">
                Style Guide <span class="text-red-500">*</span>
              </label>
              <div class="relative flex items-center ml-1 lg:ml-[0.25rem] mt-0.5 lg:mt-[0.125rem]">
                <div class="style-guide-tooltip-container">
                  <svg class="w-2.5 h-2.5 lg:w-[0.625rem] lg:h-[0.625rem] text-gray-400 cursor-help" fill="currentColor"
                    viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                    <path fill-rule="evenodd"
                      d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-3a1 1 0 00-.867.5 1 1 0 11-1.731-1A3 3 0 0113 8a3.001 3.001 0 01-2 2.83V11a1 1 0 11-2 0v-1a1 1 0 011-1 1 1 0 100-2zm0 8a1 1 0 100-2 1 1 0 000 2z"
                      clip-rule="evenodd" />
                  </svg>
                  <div class="tooltip">Upload the client style guide to ensure the content aligns with the client's
                    brand guidelines.</div>
                </div>
              </div>
            </div>

            <div *ngIf="styleGuideFileName; else noStyleGuide" class="flex flex-col gap-2">
              <span class="text-sm lg:text-[0.875rem] leading-[1rem] font-normal text-[#111111] break-all"
                [title]="styleGuideFileName">
                {{ styleGuideFileName }}
              </span>
              <button type="button" (click)="triggerStyleGuideUpload()" [disabled]="isUploadingStyleGuide"
                class="flex items-center justify-center px-5 text-sm lg:text-[0.875rem] leading-[1rem] font-bold text-white bg-[#111111] rounded-md lg:rounded-[0.375rem] hover:bg-black transition-colors disabled:opacity-50"
                style="width: 8rem; height: 2.125rem;">
                <svg xmlns="http://www.w3.org/2000/svg"
                  class="h-3 w-3 lg:h-[0.75rem] lg:w-[0.75rem] mr-1.5 lg:mr-[0.375rem]" fill="none" viewBox="0 0 24 24"
                  stroke="currentColor" *ngIf="!isUploadingStyleGuide">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                    d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12" />
                </svg>
                <span>{{ isUploadingStyleGuide ? 'Uploading...' : 'Replace' }}</span>
              </button>
            </div>

            <ng-template #noStyleGuide>
              <div class="flex justify-start">
                <button type="button" (click)="triggerStyleGuideUpload()" [disabled]="isUploadingStyleGuide"
                  class="flex items-center justify-center px-5 text-sm lg:text-[0.875rem] leading-[1rem] font-bold text-white bg-[#111111] rounded-md lg:rounded-[0.375rem] hover:bg-black transition-colors disabled:opacity-50"
                  style="width: 8rem; height: 2.125rem;">
                  <svg xmlns="http://www.w3.org/2000/svg"
                    class="h-3 w-3 lg:h-[0.75rem] lg:w-[0.75rem] mr-1.5 lg:mr-[0.375rem]" fill="none"
                    viewBox="0 0 24 24" stroke="currentColor" *ngIf="!isUploadingStyleGuide">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                      d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12" />
                  </svg>
                  <span>{{ isUploadingStyleGuide ? 'Uploading...' : 'Upload' }}</span>
                </button>
              </div>
            </ng-template>

            <input id="style-guide-upload" type="file" class="sr-only" (change)="handleStyleGuideUpload($event)"
              accept=".pdf" #styleGuideInput>
          </div>

          <div>
            <div class="flex items-start">
              <label
                class="block text-sm lg:text-[0.875rem] leading-[1rem] font-normal text-[#111111] mb-2 lg:mb-[0.5rem]">Module
                <span class="text-red-500">*</span></label>
              <div class="relative flex items-center ml-1 lg:ml-[0.25rem] mt-0.5 lg:mt-[0.125rem]">
                <div class="tooltip-container">
                  <svg class="w-2.5 h-2.5 lg:w-[0.625rem] lg:h-[0.625rem] text-gray-400 cursor-help" fill="currentColor"
                    viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                    <path fill-rule="evenodd"
                      d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-3a1 1 0 00-.867.5 1 1 0 11-1.731-1A3 3 0 0113 8a3.001 3.001 0 01-2 2.83V11a1 1 0 11-2 0v-1a1 1 0 011-1 1 1 0 100-2zm0 8a1 1 0 100-2 1 1 0 000 2z"
                      clip-rule="evenodd" />
                  </svg>
                  <div class="tooltip left-tooltip">Select the module where the outline is stored.</div>
                </div>
              </div>
            </div>
            <select [(ngModel)]="selectedModule" (change)="onModuleChange()"
              class="w-full px-2 lg:px-[0.5rem] py-1 lg:py-[0.25rem] bg-[#EEEEEE] border border-[#D3D1D1] rounded-md lg:rounded-[0.375rem] focus:ring-1 focus:ring-gray-400 focus:border-gray-400 transition-colors"
              style="height: 2.75rem; font: normal normal normal 14px/16px Roboto; color: #111111;">
              <option value="">Select a module</option>
              <option *ngFor="let module of modules" [value]="module">{{module}}</option>
            </select>
          </div>

          <div>
            <div class="flex items-start">
              <label
                class="block text-sm lg:text-[0.875rem] leading-[1rem] font-normal text-[#111111] mb-2 lg:mb-[0.5rem]">
                Outline <span class="text-red-500">*</span>
              </label>
              <div class="relative flex items-center ml-1 lg:ml-[0.25rem] mt-0.5 lg:mt-[0.125rem]">
                <div class="tooltip-container">
                  <svg class="w-2.5 h-2.5 lg:w-[0.625rem] lg:h-[0.625rem] text-gray-400 cursor-help" fill="currentColor"
                    viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                    <path fill-rule="evenodd"
                      d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-3a1 1 0 00-.867.5 1 1 0 11-1.731-1A3 3 0 0113 8a3.001 3.001 0 01-2 2.83V11a1 1 0 11-2 0v-1a1 1 0 011-1 1 1 0 100-2zm0 8a1 1 0 100-2 1 1 0 000 2z"
                      clip-rule="evenodd" />
                  </svg>
                  <div class="tooltip left-tooltip">Choose an existing outline or upload a new one.</div>
                </div>
              </div>
            </div>
            <select [(ngModel)]="selectedOutline" (change)="onOutlineChange()"
              class="w-full px-2 lg:px-[0.5rem] py-1 lg:py-[0.25rem] bg-[#EEEEEE] border border-[#D3D1D1] rounded-md lg:rounded-[0.375rem] focus:ring-1 focus:ring-gray-400 focus:border-gray-400 transition-colors"
              style="height: 2.75rem; font: normal normal normal 14px/16px Roboto; color: #111111;">
              <option value="">Select an outline</option>
              <option *ngFor="let outline of availableOutlines" [value]="outline">{{outline}}</option>
            </select>

            <div class="relative flex items-center my-2 lg:my-[0.5rem]">
              <div class="flex-grow border-t border-gray-300"></div>
              <span class="flex-shrink mx-2 lg:mx-[0.5rem] text-xs text-gray-500">OR</span>
              <div class="flex-grow border-t border-gray-300"></div>
            </div>
          </div>

          <div>
            <div class="flex items-start">
              <label
                class="block text-sm lg:text-[0.875rem] leading-[1rem] font-normal text-[#111111] mb-2 lg:mb-[0.5rem]">
                Upload Outline
              </label>
              <div class="relative flex items-center ml-1 lg:ml-[0.25rem] mt-0.5 lg:mt-[0.125rem]">
                <div class="tooltip-container">
                  <svg class="w-2.5 h-2.5 lg:w-[0.625rem] lg:h-[0.625rem] text-gray-400 cursor-help" fill="currentColor"
                    viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                    <path fill-rule="evenodd"
                      d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-3a1 1 0 00-.867.5 1 1 0 11-1.731-1A3 3 0 0113 8a3.001 3.001 0 01-2 2.83V11a1 1 0 11-2 0v-1a1 1 0 011-1 1 1 0 100-2zm0 8a1 1 0 100-2 1 1 0 000 2z"
                      clip-rule="evenodd" />
                  </svg>
                  <div class="tooltip left-tooltip">If you don't have an outline, you can upload a file here</div>
                </div>
              </div>
            </div>

            <div class="flex flex-col sm:flex-row sm:items-center gap-2">
              <label for="file-upload" class="cursor-pointer">
                <span
                  class="inline-flex items-center justify-center rounded-md lg:rounded-[0.375rem] text-white bg-[#111111] hover:bg-black transition-colors shadow-sm"
                  style="width: 8rem; height: 2.125rem;">
                  <svg xmlns="http://www.w3.org/2000/svg"
                    class="h-3 w-3 lg:h-[0.75rem] lg:w-[0.75rem] mr-1.5 lg:mr-[0.375rem]" fill="none"
                    viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                      d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12" />
                  </svg>
                  <span class="text-sm lg:text-[0.875rem] leading-[1rem] font-bold">Choose File</span>
                </span>
              </label>
              <div class="flex items-center flex-1">
                <span class="ml-0 sm:ml-2 text-sm lg:text-[0.875rem]" *ngIf="!uploadedFileName"
                  style="font: normal normal normal 14px/16px Roboto; color: #111111;">No file chosen</span>
                <span class="ml-0 sm:ml-2 text-xs text-[#111111] font-medium break-all"
                  *ngIf="uploadedFileName">{{uploadedFileName}}</span>
                <button *ngIf="uploadedFileName" (click)="clearFileUpload()" type="button"
                  class="ml-1 p-1 text-gray-500 hover:text-red-400 transition-colors">✕</button>
              </div>

              <input id="file-upload" type="file" class="sr-only" (change)="handleFileUpload($event)"
                accept=".doc,.docx">
            </div>

            <p class="mb-2 lg:mb-[0.5rem] mt-2 lg:mt-[0.5rem] text-sm lg:text-[0.875rem]"
              style="font: normal normal normal 14px/16px Roboto; color: #111111;">
              Supports: DOC & DOCX Only
            </p>

            <button *ngIf="uploadedFileName" [disabled]="isUploading" (click)="uploadOutline()"
              class="mt-2 lg:mt-[0.5rem] flex items-center justify-center px-5 text-sm lg:text-[0.875rem] leading-[1rem] font-bold text-white bg-[#111111] rounded-md lg:rounded-[0.375rem] hover:bg-black transition-colors disabled:opacity-50"
              style="width: 100%; height: 2.125rem;">
              <svg xmlns="http://www.w3.org/2000/svg"
                class="h-3 w-3 lg:h-[0.75rem] lg:w-[0.75rem] mr-1.5 lg:mr-[0.375rem]" fill="none" viewBox="0 0 24 24"
                stroke="currentColor" *ngIf="!isUploading">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                  d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12" />
              </svg>
              <span>{{isUploading ? 'Processing...' : 'Upload & Process All'}}</span>
            </button>
          </div>

          <!-- blooms level -->
          <div>
            <div class="flex items-start">
              <label
                class="block text-sm lg:text-[0.875rem] leading-[1rem] font-normal text-[#111111] mb-2 lg:mb-[0.5rem]">Bloom's
                Level <span class="text-red-500">*</span></label>
              <div class="relative flex items-center ml-1 lg:ml-[0.25rem] mt-0.5 lg:mt-[0.125rem]">
                <div class="tooltip-container">
                  <svg class="w-2.5 h-2.5 lg:w-[0.625rem] lg:h-[0.625rem] text-gray-400 cursor-help" fill="currentColor"
                    viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                    <path fill-rule="evenodd"
                      d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-3a1 1 0 00-.867.5 1 1 0 11-1.731-1A3 3 0 0113 8a3.001 3.001 0 01-2 2.83V11a1 1 0 11-2 0v-1a1 1 0 011-1 1 1 0 100-2zm0 8a1 1 0 100-2 1 1 0 000 2z"
                      clip-rule="evenodd" />
                  </svg>
                  <div class="tooltip left-tooltip">Choose the complexity level based on Bloom's Taxonomy.</div>
                </div>
              </div>
            </div>
            <select [(ngModel)]="bloomsLevel"
              class="w-full px-2 lg:px-[0.5rem] py-1 lg:py-[0.25rem] bg-[#EEEEEE] border border-[#D3D1D1] rounded-md lg:rounded-[0.375rem] focus:ring-1 focus:ring-gray-400 focus:border-gray-400 transition-colors"
              style="height: 2.75rem; font: normal normal normal 14px/16px Roboto; color: #111111;">
              <option value="">Select level</option>
              <option *ngFor="let level of bloomsLevels" [value]="level">{{level}}</option>
            </select>
          </div>

          <div>
            <div class="flex items-start">
              <label
                class="block text-sm lg:text-[0.875rem] leading-[1rem] font-normal text-[#111111] mb-2 lg:mb-[0.5rem]">Context
                Prompt</label>
              <div class="relative flex items-center ml-1 lg:ml-[0.25rem] mt-0.5 lg:mt-[0.125rem]">
                <div class="tooltip-container">
                  <svg class="w-2.5 h-2.5 lg:w-[0.625rem] lg:h-[0.625rem] text-gray-400 cursor-help" fill="currentColor"
                    viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                    <path fill-rule="evenodd"
                      d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-3a1 1 0 00-.867.5 1 1 0 11-1.731-1A3 3 0 0113 8a3.001 3.001 0 01-2 2.83V11a1 1 0 11-2 0v-1a1 1 0 011-1 1 1 0 100-2zm0 8a1 1 0 100-2 1 1 0 000 2z"
                      clip-rule="evenodd" />
                  </svg>

                  <div class="tooltip left-tooltip text-xs leading-snug">
                    <strong>Add context for storyboard generation. Examples:</strong>

                    <ul class="custom-bullets">
                      <li>Create a storyboard with limited on-screen text (OST)</li>
                      <li>Create a storyboard with limited narration</li>
                      <li>Create a storyboard including both OST and narration verbatim</li>
                      <li>Create a non-audio storyboard for a level 2 course</li>
                      <li>Create a storyboard for a scenario-based module</li>
                      <li>Create a storyboard with simulations in both show-me and try-me modes</li>
                      <li>Create a storyboard where all knowledge checks are scenario-based</li>
                      <li>Create a storyboard in a conversational tone</li>
                    </ul>
                  </div>
                </div>

              </div>
            </div>
            <textarea [(ngModel)]="contextPrompt" rows="3"
              class="w-full px-2 lg:px-[0.5rem] py-1 lg:py-[0.25rem] bg-[#EEEEEE] border border-[#D3D1D1] rounded-md lg:rounded-[0.375rem] focus:ring-1 focus:ring-gray-400 focus:border-gray-400"
              placeholder="Enter any additional context or instructions..."
              style="height: 4rem; font: normal normal normal 14px/16px Roboto; color: #111111;"></textarea>
          </div>


          <div class="space-y-2 lg:space-y-[0.5rem]">
            <div class="flex items-center">
              <input [(ngModel)]="isNASBA" id="nasba-checkbox" type="checkbox"
                class="h-3 w-3 lg:h-[0.75rem] lg:w-[0.75rem] border-[#D3D1D1] rounded accent-purple-500">
              <label for="nasba-checkbox"
                class="ml-2 lg:ml-[0.5rem] block text-sm lg:text-[0.875rem] leading-[1rem] font-normal text-[#111111]">NASBA
                Compliant</label>
              <div class="relative flex items-center ml-1 lg:ml-[0.25rem]">
                <div class="tooltip-container">
                  <svg class="w-2.5 h-2.5 lg:w-[0.625rem] lg:h-[0.625rem] text-gray-400 cursor-help" fill="currentColor"
                    viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                    <path fill-rule="evenodd"
                      d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-3a1 1 0 00-.867.5 1 1 0 11-1.731-1A3 3 0 0113 8a3.001 3.001 0 01-2 2.83V11a1 1 0 11-2 0v-1a1 1 0 011-1 1 1 0 100-2zm0 8a1 1 0 100-2 1 1 0 000 2z"
                      clip-rule="evenodd" />
                  </svg>
                  <div class="tooltip left-tooltip">Ensure the content complies with the standards of the National
                    Association of State Boards of Accountancy.</div>
                </div>
              </div>
            </div>
            <div class="flex items-center">
              <input [(ngModel)]="isUKEnglish" id="uk-english-checkbox" type="checkbox"
                class="h-3 w-3 lg:h-[0.75rem] lg:w-[0.75rem] border-[#D3D1D1] rounded accent-purple-500">
              <label for="uk-english-checkbox"
                class="ml-2 lg:ml-[0.5rem] block text-sm lg:text-[0.875rem] leading-[1rem] font-normal text-[#111111]">UK
                English</label>
              <div class="relative flex items-center ml-1 lg:ml-[0.25rem]">
                <div class="tooltip-container">
                  <svg class="w-2.5 h-2.5 lg:w-[0.625rem] lg:h-[0.625rem] text-gray-400 cursor-help" fill="currentColor"
                    viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                    <path fill-rule="evenodd"
                      d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-3a1 1 0 00-.867.5 1 1 0 11-1.731-1A3 3 0 0113 8a3.001 3.001 0 01-2 2.83V11a1 1 0 11-2 0v-1a1 1 0 011-1 1 1 0 100-2zm0 8a1 1 0 100-2 1 1 0 000 2z"
                      clip-rule="evenodd" />
                  </svg>
                  <div class="tooltip left-tooltip">Use UK English spelling and terminology (default is US English)
                  </div>
                </div>
              </div>
            </div>
          </div>

          <div class="pt-2 lg:pt-[0.5rem]">

            <button (click)="submitStoryboard()" [disabled]="!canGenerate()"
              class="flex justify-center items-center text-white disabled:opacity-50 transition-colors w-full mb-10"
              style="height: 2.125rem; border-radius: 0.375rem; background: linear-gradient(93deg, #588AFF 0%, #8E0ED8 100%);">
              <span class="text-sm lg:text-[0.875rem] leading-[1rem] font-bold">{{isLoading ? 'Generating...' :
                'Generate Storyboard'}}</span>
            </button>
          </div>

        </div>
      </div>
    </div>

    <!-- responsive -->
    <div class="flex-1 flex flex-col overflow-hidden">
      <div class="flex-1 overflow-auto">
        <div class="max-w-full mx-auto px-[0.5rem] sm:px-[0.75rem] lg:px-[1.25rem] py-[0.75rem] h-full">
          <div *ngIf="!storyboards || storyboards.length === 0"
            class="bg-white p-[1.5rem] sm:p-[2rem] rounded-xl shadow-sm border border-gray-200 h-[40.125rem] flex flex-col items-center justify-center">
            <div
              class="w-[5rem] h-[5rem] sm:w-[6rem] sm:h-[6rem] bg-purple-100 rounded-full flex items-center justify-center mb-[1rem]">
              <svg xmlns="http://www.w3.org/2000/svg"
                class="h-[2.5rem] w-[2.5rem] sm:h-[3rem] sm:w-[3rem] text-purple-600" fill="none" viewBox="0 0 24 24"
                stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5"
                  d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
              </svg>
            </div>
            <h3 class="text-[1.125rem] font-medium text-[#111111] mb-[0.5rem]">No storyboard generated yet</h3>
            <p class="text-[1rem] text-gray-600 max-w-md text-center">Fill out the parameters and click "Generate
              Storyboard" to create a storyboard for the chosen outline.</p>
          </div>

          <div *ngIf="storyboards && storyboards.length > 0" class="h-full">
            <div
              class="bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden h-[40.125rem] flex flex-col font-roboto">

              <!-- Responsive container with horizontal scrolling -->
              <div class="overflow-x-auto flex-1">
                <div class="min-w-[800px]"> <!-- Minimum width for the table -->
                  <table class="w-full divide-y divide-gray-200">
                    <colgroup>
                      <col class="w-1/4 min-w-[160px]">
                      <col class="w-3/4 min-w-[240px]">
                    </colgroup>
                    <tbody class="bg-white divide-y divide-gray-200">
                      <tr *ngIf="currentStoryboard">
                        <!-- Topic -->
                        <td class="px-[0.75rem] py-[0.5rem] text-left font-medium text-[#111111] align-top border-r"
                          style="font: normal normal medium 0.875rem/1rem Roboto; white-space: nowrap;">
                          Topic
                        </td>
                        <td class="px-[0.75rem] py-[0.5rem] align-top">
                          <div *ngIf="!isEditing"
                            style="font: normal normal normal 0.875rem/1rem Roboto; color: #111111;">
                            {{currentStoryboard?.Topic || 'N/A'}}
                          </div>
                          <input *ngIf="isEditing" [(ngModel)]="currentStoryboard.Topic"
                            class="w-full px-[0.5rem] py-[0.25rem] border border-[#D3D1D1] rounded-[0.375rem]"
                            style="font: normal normal normal 0.875rem/1rem Roboto; color: #111111;">
                        </td>
                      </tr>

                      <!-- Screen Type -->
                      <tr>
                        <td class="px-[0.75rem] py-[0.5rem] text-left font-medium text-[#111111] align-top border-r"
                          style="font: normal normal medium 0.875rem/1rem Roboto; white-space: nowrap;">
                          Screen Type
                        </td>
                        <td class="px-[0.75rem] py-[0.5rem] align-top">
                          <div *ngIf="!isEditing"
                            style="font: normal normal normal 0.875rem/1rem Roboto; color: #111111;">
                            {{currentStoryboard?.Screen_type || 'N/A'}}
                          </div>
                          <input *ngIf="isEditing" [(ngModel)]="currentStoryboard.Screen_type"
                            class="w-full px-[0.5rem] py-[0.25rem] border border-[#D3D1D1] rounded-[0.375rem]"
                            style="font: normal normal normal 0.875rem/1rem Roboto; color: #111111;">
                        </td>
                      </tr>


                      <!-- Learning Objectives -->
                      <tr>

                        <td class="px-[0.75rem] py-[0.5rem] text-left font-medium text-[#111111] align-top border-r"
                          style="font: normal normal medium 0.875rem/1rem Roboto; white-space: nowrap;">
                          Learning Objectives
                        </td>
                        <td class="px-[0.75rem] py-[0.5rem] align-top">
                          <div *ngIf="!isEditing"
                            style="font: normal normal normal 0.875rem/1rem Roboto; color: #111111;">
                            <ul class="list-disc pl-[0.75rem]">
                              <li *ngFor="let objective of currentStoryboard?.Learning_Objectives">{{objective}}</li>
                            </ul>
                          </div>
                          <textarea *ngIf="isEditing" [(ngModel)]="learningObjectivesInput" rows="3"
                            class="w-full px-[0.75rem] py-[0.5rem] border border-[#D3D1D1] rounded-[0.5rem]"
                            style="font: normal normal normal 0.875rem/1rem Roboto; color: #111111;"
                            placeholder="Enter each learning objective on a new line"></textarea>
                        </td>
                      </tr>


                      <!-- On-screen Text -->
                      <tr>

                        <td class="px-[0.75rem] py-[0.5rem] text-left font-medium text-[#111111] align-top border-r"
                          style="font: normal normal medium 0.875rem/1rem Roboto; white-space: nowrap;">
                          On-screen Text
                        </td>

                        <td class="px-[0.75rem] py-[0.5rem] align-top">
                          <div *ngIf="!isEditing"
                            style="font: normal normal normal 0.875rem/1rem Roboto; color: #111111; white-space: pre-line;">
                            {{currentStoryboard?.On_screen_text || 'N/A'}}
                          </div>
                          <textarea *ngIf="isEditing" [(ngModel)]="onScreenTextInput" rows="10"
                            class="w-full px-[0.5rem] py-[0.25rem] border border-[#D3D1D1] rounded-[0.375rem]"
                            style="font: normal normal normal 0.875rem/1rem Roboto; color: #111111;"></textarea>
                        </td>
                      </tr>


                      <!-- Narration -->
                      <tr>

                        <td class="px-[0.75rem] py-[0.5rem] text-left font-medium text-[#111111] align-top border-r"
                          style="font: normal normal medium 0.875rem/1rem Roboto; white-space: nowrap;">
                          Narration
                        </td>

                        <td class="px-[0.75rem] py-[0.5rem] align-top">
                          <div *ngIf="!isEditing"
                            style="font: normal normal normal 0.875rem/1rem Roboto; color: #111111; white-space: pre-line;">
                            {{currentStoryboard?.Narration || 'N/A'}}
                          </div>
                          <textarea *ngIf="isEditing" [(ngModel)]="currentStoryboard.Narration" rows="10"
                            class="w-full px-[0.5rem] py-[0.25rem] border border-[#D3D1D1] rounded-[0.375rem]"
                            style="font: normal normal normal 0.875rem/1rem Roboto; color: #111111;"></textarea>
                        </td>
                      </tr>

                      <!-- Recommendations -->
                      <tr>

                        <td class="px-[0.75rem] py-[0.5rem] text-left font-medium text-[#111111] align-top border-r"
                          style="font: normal normal medium 0.875rem/1rem Roboto; white-space: nowrap;">
                          Recommendations
                        </td>

                        <td class="px-[0.75rem] py-[0.5rem] align-top">
                          <div *ngIf="!isEditing"
                            style="font: normal normal normal 0.875rem/1rem Roboto; color: #111111;">
                            <ul class="list-disc pl-[0.75rem]">
                              <li *ngFor="let rec of currentStoryboard?.On_screen_Recommendations">{{rec}}</li>
                            </ul>
                          </div>
                          <textarea *ngIf="isEditing" [(ngModel)]="recommendationsInput" rows="10"
                            class="w-full px-[0.5rem] py-[0.25rem] border border-[#D3D1D1] rounded-[0.375rem]"
                            style="font: normal normal normal 0.875rem/1rem Roboto; color: #111111;"></textarea>
                        </td>
                      </tr>

                      <!-- Developer Notes -->
                      <tr>

                        <td class="px-[0.75rem] py-[0.5rem] text-left font-medium text-[#111111] align-top border-r"
                          style="font: normal normal medium 0.875rem/1rem Roboto; white-space: nowrap;">
                          Developer Notes
                        </td>

                        <td class="px-[0.75rem] py-[0.5rem] align-top">
                          <div *ngIf="!isEditing"
                            style="font: normal normal normal 0.875rem/1rem Roboto; color: #111111;">
                            <ul class="list-disc pl-[0.75rem]">
                              <li *ngFor="let note of currentStoryboard?.Developer_Notes">{{note}}</li>
                            </ul>
                          </div>
                          <textarea *ngIf="isEditing" [(ngModel)]="developerNotesInput" rows="10"
                            class="w-full px-[0.5rem] py-[0.25rem] border border-[#D3D1D1] rounded-[0.375rem]"
                            style="font: normal normal normal 0.875rem/1rem Roboto; color: #111111;"></textarea>
                        </td>
                      </tr>


                      <!-- Duration (min) -->
                      <tr>
                        <td class="px-[0.75rem] py-[0.5rem] text-left font-medium text-[#111111] align-top border-r"
                          style="font: normal normal medium 0.875rem/1rem Roboto; white-space: nowrap;">
                          Duration (min)
                        </td>
                        <td class="px-[0.75rem] py-[0.5rem] align-top">
                          <div *ngIf="!isEditing"
                            style="font: normal normal normal 0.875rem/1rem Roboto; color: #111111;">
                            {{getField(currentStoryboard, 'Duration_(min)') || 'N/A'}}
                          </div>
                          <input *ngIf="isEditing" [ngModel]="getField(currentStoryboard, 'Duration_(min)')"
                            (ngModelChange)="setField('Duration_(min)', $event)"
                            class="w-full px-[0.5rem] py-[0.25rem] border border-[#D3D1D1] rounded-[0.375rem]"
                            style="font: normal normal normal 0.875rem/1rem Roboto; color: #111111;">
                        </td>
                      </tr>

                      <!-- Source Images-->
                      <tr>
                        <td class="px-[0.75rem] py-[0.5rem] text-left font-medium text-[#111111] align-top border-r"
                          style="font: normal normal medium 0.875rem/1rem Roboto; white-space: nowrap;">
                          Source Images
                        </td>
                        <td class="px-[0.75rem] py-[0.5rem] align-top">
                          <!-- Display mode -->
                          <div *ngIf="!isEditing"
                            style="font: normal normal normal 0.875rem/1rem Roboto; color: #111111;">
                            <div
                              *ngIf="getField(currentStoryboard, 'Source_Images_(base64)') && getField(currentStoryboard, 'Source_Images_(base64)').length > 0">
                              <div
                                *ngFor="let image of getField(currentStoryboard, 'Source_Images_(base64)'); let i = index"
                                class="mb-4">
                                <div *ngIf="image !== 'N/A' && image">
                                  <img [src]="'data:image/png;base64,' + image"
                                    class="max-w-full h-auto mb-2 border border-gray-300" style="max-height: 150px;">
                                  <!-- <div class="text-sm text-gray-500">Image {{i + 1}}</div> -->
                                </div>
                                <div *ngIf="image === 'N/A' || !image" class="text-gray-500">
                                  No image available
                                </div>
                              </div>
                            </div>
                            <div
                              *ngIf="!getField(currentStoryboard, 'Source_Images_(base64)') || getField(currentStoryboard, 'Source_Images_(base64)').length === 0">
                              No images available
                            </div>
                          </div>

                          <!-- Edit mode -->
                          <div *ngIf="isEditing">
                            <div *ngIf="sourceImages && sourceImages.length > 0">
                              <div *ngFor="let image of sourceImages; let i = index"
                                class="mb-4 p-2 border border-gray-200 rounded">
                                <div *ngIf="image && image !== 'N/A'">
                                  <img [src]="'data:image/png;base64,' + image"
                                    class="max-w-full h-auto mb-2 border border-gray-300" style="max-height: 150px;">
                                  <div class="flex items-center gap-2">
                                    <button type="button" (click)="removeImage(i)"
                                      class="text-red-600 text-sm hover:text-red-800">
                                      Remove Image
                                    </button>
                                    <!-- <span class="text-sm text-gray-500">Image {{i + 1}}</span> -->
                                  </div>
                                </div>
                                <div *ngIf="!image || image === 'N/A'" class="text-gray-500">
                                  No image available
                                </div>
                              </div>
                            </div>
                            <div *ngIf="!sourceImages || sourceImages.length === 0" class="text-gray-500">
                              No images available
                            </div>
                          </div>
                        </td>
                      </tr>


                    </tbody>
                  </table>
                </div>
              </div>

              <div
                class="px-[0.75rem] py-[0.5rem] bg-gray-50 border-t border-gray-200 flex flex-col sm:flex-row justify-between items-center gap-[0.75rem] font-roboto">

                <div class="flex items-center space-x-[0.5rem] order-2 sm:order-1">
                  <!-- Edit Button -->
                  <button *ngIf="!isEditing" (click)="toggleEditMode()"
                    class="inline-flex items-center justify-center text-white bg-[#111111] hover:bg-black transition-colors tooltip-container"
                    style="width: 2.1875rem; height: 2.1875rem; border-radius: 0.375rem;">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-[1rem] w-[1rem]" fill="none" viewBox="0 0 24 24"
                      stroke="currentColor">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5"
                        d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z" />
                    </svg>
                    <span class="tooltip-button">Edit</span>
                  </button>

                  <!-- Cancel Button -->
                  <button *ngIf="isEditing" (click)="toggleEditMode()"
                    class="inline-flex items-center justify-center text-red-400 bg-red-900/30 hover:bg-red-900/50 border border-red-700/50 transition-colors tooltip-container"
                    style="width: 2.1875rem; height: 2.1875rem; border-radius: 0.375rem;">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-[0.75rem] w-[0.75rem]" fill="none"
                      viewBox="0 0 24 24" stroke="currentColor">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5"
                        d="M6 18L18 6M6 6l12 12" />
                    </svg>
                    <span class="tooltip-button">Cancel</span>
                  </button>

                  <!-- Save Button -->
                  <button *ngIf="isEditing" (click)="saveEditing()" [disabled]="isSaving"
                    class="inline-flex items-center justify-center text-white bg-green-600 hover:bg-green-500 border border-green-500 transition-colors disabled:opacity-50 tooltip-container"
                    style="width: 2.1875rem; height: 2.1875rem; border-radius: 0.375rem;">
                    <svg *ngIf="isSaving" class="animate-spin h-[0.75rem] w-[0.75rem] text-white"
                      xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                      <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                      <path class="opacity-75" fill="currentColor"
                        d="M4 12a8 8 0 018-8v4l3-3-3-3v4a8 8 0 100 16v-4l-3 3 3 3v-4a8 8 0 01-8-8z"></path>
                    </svg>
                    <svg *ngIf="!isSaving" xmlns="http://www.w3.org/2000/svg" class="h-[0.75rem] w-[0.75rem]"
                      fill="none" viewBox="0 0 24 24" stroke="currentColor">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M5 13l4 4L19 7" />
                    </svg>
                    <span class="tooltip-button">Save</span>
                  </button>
                </div>

                <div *ngIf="storyboards && storyboards.length > 0"
                  class="flex items-center gap-[0.25rem] order-1 sm:order-2 mb-[0.75rem] sm:mb-0">
                  <button (click)="prevStoryboard()" [disabled]="currentIndex === 0 || isEditing"
                    class="flex items-center justify-center bg-white border border-gray-300 text-gray-600 hover:bg-gray-50 hover:text-[#588AFF] transition-colors disabled:opacity-40 disabled:cursor-not-allowed"
                    style="width: 2.1875rem; height: 2.1875rem; border-radius: 0.375rem;" title="Previous storyboard">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-[1rem] w-[1rem]" viewBox="0 0 20 20"
                      fill="currentColor">
                      <path fill-rule="evenodd"
                        d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z"
                        clip-rule="evenodd" />
                    </svg>
                  </button>

                  <div
                    class="flex items-center gap-[0.25rem] mx-[0.5rem] px-[0.75rem] py-[0.25rem] bg-gray-100 rounded-md">
                    <span class="text-[0.75rem] font-medium text-gray-700">{{currentIndex + 1}}</span>
                    <span class="text-[0.75rem] text-gray-500">of</span>
                    <span class="text-[0.75rem] font-medium text-gray-700">{{storyboards.length}}</span>
                  </div>

                  <button (click)="nextStoryboard()" [disabled]="currentIndex === storyboards.length - 1  || isEditing"
                    class="flex items-center justify-center bg-white border border-gray-300 text-gray-600 hover:bg-gray-50 hover:text-[#588AFF] transition-colors disabled:opacity-40 disabled:cursor-not-allowed"
                    style="width: 2.1875rem; height: 2.1875rem; border-radius: 0.375rem;" title="Next storyboard">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-[1rem] w-[1rem]" viewBox="0 0 20 20"
                      fill="currentColor">
                      <path fill-rule="evenodd"
                        d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z"
                        clip-rule="evenodd" />
                    </svg>
                  </button>
                </div>

                <div class="flex items-center space-x-[0.5rem] order-3 mb-2">

                  <button (click)="toggleApplyMode()"
                    class="inline-flex items-center justify-center text-white bg-[#111111] hover:bg-black transition-colors tooltip-container"
                    style="width: 2.1875rem; height: 2.1875rem; border-radius: 0.375rem;">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-[1rem] w-[1rem]" fill="none" viewBox="0 0 24 24"
                      stroke="currentColor">
                      <rect x="8" y="8" width="8" height="8" rx="1" stroke="currentColor" stroke-width="1.5" />
                      <path stroke="currentColor" stroke-width="1.5" stroke-linecap="round"
                        d="M4 10h2M4 14h2M18 10h2M18 14h2M10 4v2M14 4v2M10 18v2M14 18v2" />
                    </svg>
                    <span class="tooltip-button">Prompt to edit</span>
                  </button>

                  <button (click)="downloadStoryboard()" [disabled]="isDownloading"
                    class="inline-flex items-center justify-center text-white bg-[#111111] hover:bg-black transition-colors tooltip-container"
                    style="width: 2.1875rem; height: 2.1875rem; border-radius: 0.375rem;">
                    <svg *ngIf="isDownloading" class="animate-spin h-[1rem] w-[1rem] text-white"
                      xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                      <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                      <path class="opacity-75" fill="currentColor"
                        d="M4 12a8 8 0 018-8v4l3-3-3-3v4a8 8 0 100 16v-4l-3 3 3 3v-4a8 8 0 01-8-8z"></path>
                    </svg>
                    <svg *ngIf="!isDownloading" xmlns="http://www.w3.org/2000/svg" class="h-[1rem] w-[1rem]" fill="none"
                      viewBox="0 0 24 24" stroke="currentColor">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5"
                        d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4" />
                    </svg>
                    <span class="tooltip-button">Download</span>
                  </button>

                </div>
              </div>

              <div *ngIf="showApplySection" class="px-[0.75rem] py-[0.5rem] bg-gray-100 border-t border-gray-200">
                <div class="flex flex-col sm:flex-row gap-[0.75rem] items-start sm:items-center">
                  <div class="w-full sm:w-auto">
                    <label class="block text-[0.875rem] leading-[1rem] font-normal text-[#111111] mb-[0.5rem]">Apply
                      Changes To </label>
                    <div class="flex space-x-[0.75rem]">
                      <div class="flex items-center">
                        <input type="radio" id="apply-current" [(ngModel)]="applyOption" value="current"
                          class="h-[0.625rem] w-[0.625rem] border-gray-300 focus:ring-gray-400">
                        <label for="apply-current"
                          class="ml-[0.375rem] block text-[0.875rem] leading-[1rem] font-normal text-[#111111]">Current
                          Screen</label>
                      </div>

                      <div class="flex items-center">
                        <input type="radio" id="apply-all" [(ngModel)]="applyOption" value="all"
                          class="h-[0.625rem] w-[0.625rem] border-gray-300 focus:ring-gray-400">
                        <label for="apply-all"
                          class="ml-[0.375rem] block text-[0.875rem] leading-[1rem] font-normal text-[#111111]">All
                          Screens</label>
                      </div>
                    </div>
                  </div>

                  <div class="w-full sm:flex-1 min-w-[10rem]">
                    <label class="block text-[0.875rem] leading-[1rem] font-normal text-[#111111] mb-[0.5rem]">Prompt to
                      Edit</label>
                    <textarea [(ngModel)]="modificationPrompt" rows="2" required
                      class="w-full px-[0.5rem] py-[0.25rem] bg-[#EEEEEE] border border-[#D3D1D1] rounded-[0.375rem] focus:ring-1 focus:ring-gray-400 focus:border-gray-400 min-h-[3rem]"
                      placeholder="Enter detailed instructions for the changes you want to apply..."
                      style="font: normal normal normal 0.875rem/1rem Roboto; color: #111111;"></textarea>
                  </div>

                  <div class="w-full sm:w-auto flex items-end">
                    <button (click)="applyChanges()" [disabled]="!modificationPrompt || isApplying"
                      class="inline-flex items-center justify-center text-white bg-[#111111] hover:bg-black transition-colors disabled:opacity-50"
                      style="width: 6.875rem; height: 2.125rem; border-radius: 0.375rem;">
                      <svg *ngIf="isApplying" class="animate-spin h-[0.75rem] w-[0.75rem] mr-[0.375rem] text-white"
                        xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                        <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4">
                        </circle>
                        <path class="opacity-75" fill="currentColor"
                          d="M4 12a8 8 0 018-8v4l3-3-3-3v4a8 8 0 100 16v-4l-3 3 3 3v-4a8 8 0 01-8-8z"></path>
                      </svg>
                      <span style="font: normal normal bold 0.875rem/1rem Roboto; color: #FFFFFF;">
                        {{isApplying ? 'Applying...' : 'Apply Changes'}}
                      </span>
                    </button>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>


  </div>
</div>
